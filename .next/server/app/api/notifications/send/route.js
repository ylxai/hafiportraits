"use strict";(()=>{var t={};t.id=285,t.ids=[285],t.modules={517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2974:(t,e,n)=>{n.r(e),n.d(e,{headerHooks:()=>y,originalPathname:()=>w,patchFetch:()=>b,requestAsyncStorage:()=>g,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>k});var i={};n.r(i),n.d(i,{POST:()=>c});var o=n(5419),s=n(9108),r=n(9678),a=n(8070);async function c(t){try{let{title:e,message:n,type:i="general",priority:o="normal",recipients:s="all",data:r={},scheduled:c=null,topic:p=null}=await t.json();if(!e||!n)return a.Z.json({success:!1,error:"Title and message are required"},{status:400});let g={id:`notif_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,title:e,body:n,icon:"/icons/icon-192x192.png",badge:"/icons/badge-72x72.png",image:r.imageUrl||null,data:{type:i,priority:o,url:r.url||"/admin",timestamp:new Date().toISOString(),...r},actions:[{action:"view",title:"Lihat"},{action:"dismiss",title:"Tutup"}]},h=[];if("all"===s)h=await l();else if(Array.isArray(s))h=s;else if(p)return await d(p,g),a.Z.json({success:!0,data:{notificationId:g.id,type:"topic",topic:p,message:"Notification sent to topic successfully"}});let m=await u(h,g);return await f({...g,recipients:h.length,sentAt:new Date().toISOString(),results:m}),a.Z.json({success:!0,data:{notificationId:g.id,type:"tokens",recipients:h.length,successful:m.successful,failed:m.failed,message:"Notification sent successfully"}})}catch(t){return console.error("❌ Error sending notification:",t),a.Z.json({success:!1,error:"Failed to send notification"},{status:500})}}async function l(){return["mock_token_1","mock_token_2","mock_token_3"]}async function u(t,e){try{let e=0,n=0;for(let i of t)try{console.log(`✅ Notification sent to token: ${i.substring(0,16)}...`),e++}catch(t){console.error(`❌ Failed to send to token: ${i.substring(0,16)}...`,t),n++}return{successful:e,failed:n}}catch(e){return console.error("❌ Error in sendToTokens:",e),{successful:0,failed:t.length}}}async function d(t,e){try{console.log(`✅ Notification sent to topic: ${t}`)}catch(e){throw console.error(`❌ Failed to send to topic: ${t}`,e),e}}async function f(t){try{console.log("\uD83D\uDCDD Storing notification history:",{id:t.id,title:t.title,recipients:t.recipients,sentAt:t.sentAt})}catch(t){console.error("❌ Error storing notification history:",t)}}let p=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/notifications/send/route",pathname:"/api/notifications/send",filename:"route",bundlePath:"app/api/notifications/send/route"},resolvedPagePath:"C:\\Users\\Administrator\\nana-cursor-admin-dashboard-gallery-feature-enhancement-a647\\hafi-portrait-stable\\src\\app\\api\\notifications\\send\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:m,headerHooks:y,staticGenerationBailout:k}=p,w="/api/notifications/send/route";function b(){return(0,r.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}}};var e=require("../../../../webpack-runtime.js");e.C(t);var n=t=>e(e.s=t),i=e.X(0,[638,206],()=>n(2974));module.exports=i})();