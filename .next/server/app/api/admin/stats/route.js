/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/admin/stats/route";
exports.ids = ["app/api/admin/stats/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "sharp":
/*!************************!*\
  !*** external "sharp" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("sharp");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "?32c4":
/*!****************************!*\
  !*** bufferutil (ignored) ***!
  \****************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?66e9":
/*!********************************!*\
  !*** utf-8-validate (ignored) ***!
  \********************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fstats%2Froute&page=%2Fapi%2Fadmin%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fstats%2Froute.ts&appDir=%2Fhome%2Fdevbox%2Fhafi-portrait-stable%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fdevbox%2Fhafi-portrait-stable&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fstats%2Froute&page=%2Fapi%2Fadmin%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fstats%2Froute.ts&appDir=%2Fhome%2Fdevbox%2Fhafi-portrait-stable%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fdevbox%2Fhafi-portrait-stable&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_devbox_hafi_portrait_stable_src_app_api_admin_stats_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/admin/stats/route.ts */ \"(rsc)/./src/app/api/admin/stats/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/admin/stats/route\",\n        pathname: \"/api/admin/stats\",\n        filename: \"route\",\n        bundlePath: \"app/api/admin/stats/route\"\n    },\n    resolvedPagePath: \"/home/devbox/hafi-portrait-stable/src/app/api/admin/stats/route.ts\",\n    nextConfigOutput,\n    userland: _home_devbox_hafi_portrait_stable_src_app_api_admin_stats_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/admin/stats/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhZG1pbiUyRnN0YXRzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhZG1pbiUyRnN0YXRzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGYWRtaW4lMkZzdGF0cyUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGZGV2Ym94JTJGaGFmaS1wb3J0cmFpdC1zdGFibGUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmhvbWUlMkZkZXZib3glMkZoYWZpLXBvcnRyYWl0LXN0YWJsZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNrQjtBQUMvRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL2hhZmlwb3J0cmFpdC1uZXh0anMvPzg2NmUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL2hvbWUvZGV2Ym94L2hhZmktcG9ydHJhaXQtc3RhYmxlL3NyYy9hcHAvYXBpL2FkbWluL3N0YXRzL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hZG1pbi9zdGF0cy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2FkbWluL3N0YXRzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hZG1pbi9zdGF0cy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9ob21lL2RldmJveC9oYWZpLXBvcnRyYWl0LXN0YWJsZS9zcmMvYXBwL2FwaS9hZG1pbi9zdGF0cy9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hZG1pbi9zdGF0cy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fstats%2Froute&page=%2Fapi%2Fadmin%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fstats%2Froute.ts&appDir=%2Fhome%2Fdevbox%2Fhafi-portrait-stable%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fdevbox%2Fhafi-portrait-stable&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/admin/stats/route.ts":
/*!******************************************!*\
  !*** ./src/app/api/admin/stats/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_database__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/database */ \"(rsc)/./src/lib/database.ts\");\n\n // Mengimpor database langsung\nasync function GET() {\n    try {\n        const stats = await _lib_database__WEBPACK_IMPORTED_MODULE_1__.database.getStats(); // Menggunakan database langsung\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(stats);\n    } catch (error) {\n        console.error(\"Get stats error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            message: \"Failed to fetch stats\",\n            error: error.message\n        }, {\n            status: 400\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hZG1pbi9zdGF0cy9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBMkM7QUFDRCxDQUFDLDhCQUE4QjtBQUVsRSxlQUFlRTtJQUNwQixJQUFJO1FBQ0YsTUFBTUMsUUFBUSxNQUFNRixtREFBUUEsQ0FBQ0csUUFBUSxJQUFJLGdDQUFnQztRQUN6RSxPQUFPSixrRkFBWUEsQ0FBQ0ssSUFBSSxDQUFDRjtJQUMzQixFQUFFLE9BQU9HLE9BQVk7UUFDbkJDLFFBQVFELEtBQUssQ0FBQyxvQkFBb0JBO1FBQ2xDLE9BQU9OLGtGQUFZQSxDQUFDSyxJQUFJLENBQ3RCO1lBQUVHLFNBQVM7WUFBeUJGLE9BQU9BLE1BQU1FLE9BQU87UUFBQyxHQUN6RDtZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2hhZmlwb3J0cmFpdC1uZXh0anMvLi9zcmMvYXBwL2FwaS9hZG1pbi9zdGF0cy9yb3V0ZS50cz85ZjJhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcclxuaW1wb3J0IHsgZGF0YWJhc2UgfSBmcm9tICdAL2xpYi9kYXRhYmFzZSc7IC8vIE1lbmdpbXBvciBkYXRhYmFzZSBsYW5nc3VuZ1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVCgpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc3RhdHMgPSBhd2FpdCBkYXRhYmFzZS5nZXRTdGF0cygpOyAvLyBNZW5nZ3VuYWthbiBkYXRhYmFzZSBsYW5nc3VuZ1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHN0YXRzKTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdHZXQgc3RhdHMgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IG1lc3NhZ2U6IFwiRmFpbGVkIHRvIGZldGNoIHN0YXRzXCIsIGVycm9yOiBlcnJvci5tZXNzYWdlIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZGF0YWJhc2UiLCJHRVQiLCJzdGF0cyIsImdldFN0YXRzIiwianNvbiIsImVycm9yIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJzdGF0dXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/admin/stats/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/database.ts":
/*!*****************************!*\
  !*** ./src/lib/database.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   database: () => (/* binding */ database)\n/* harmony export */ });\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase */ \"(rsc)/./src/lib/supabase.ts\");\n/* harmony import */ var _image_optimizer_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./image-optimizer-server */ \"(rsc)/./src/lib/image-optimizer-server.ts\");\n // Pastikan ini diimpor dengan benar\n\nclass DatabaseService {\n    constructor(){\n        this.supabase = _supabase__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin;\n        this.imageOptimizer = new _image_optimizer_server__WEBPACK_IMPORTED_MODULE_1__.ImageOptimizerServer(this.supabase, \"photos\");\n    }\n    // --- Metode Event ---\n    async getAllEvents() {\n        const { data, error } = await this.supabase.from(\"events\").select(\"*\").order(\"date\", {\n            ascending: false\n        });\n        if (error) throw error;\n        return data;\n    }\n    async getPublicEvents() {\n        const { data, error } = await this.supabase.from(\"events\").select(\"id, name, date, is_premium, qr_code, shareable_link\").is(\"is_premium\", false) // Asumsi hanya event non-premium yang publik, sesuaikan jika perlu\n        .order(\"date\", {\n            ascending: false\n        });\n        if (error) throw error;\n        return data;\n    }\n    async getEventById(id) {\n        const { data, error } = await this.supabase.from(\"events\").select(\"*\").eq(\"id\", id).single();\n        if (error) throw error;\n        return data;\n    }\n    async createEvent(event) {\n        // First, insert the event to get the ID\n        const { data: newEvent, error } = await this.supabase.from(\"events\").insert(event).select().single();\n        if (error) throw error;\n        try {\n            // Generate QR code and shareable link\n            const baseUrl = process.env.NEXT_PUBLIC_APP_URL || \"http://localhost:3000\";\n            const eventUrl = `${baseUrl}/event/${newEvent.id}?code=${newEvent.access_code}`;\n            // Generate QR code using a service like QRServer.com\n            const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(eventUrl)}`;\n            // Update the event with QR code and shareable link\n            const { data: updatedEvent, error: updateError } = await this.supabase.from(\"events\").update({\n                qr_code: qrCodeUrl,\n                shareable_link: eventUrl\n            }).eq(\"id\", newEvent.id).select().single();\n            if (updateError) throw updateError;\n            return updatedEvent;\n        } catch (updateError) {\n            console.error(\"Error generating QR code:\", updateError);\n            // Return the event even if QR code generation fails\n            return newEvent;\n        }\n    }\n    async updateEvent(id, updates) {\n        const { data, error } = await this.supabase.from(\"events\").update(updates).eq(\"id\", id).select().single();\n        if (error) throw error;\n        return data;\n    }\n    async deleteEvent(id) {\n        const { error } = await this.supabase.from(\"events\").delete().eq(\"id\", id);\n        if (error) throw error;\n    }\n    async verifyEventAccessCode(eventId, code) {\n        const { data, error } = await this.supabase.from(\"events\").select(\"id\").eq(\"id\", eventId).eq(\"access_code\", code).single();\n        if (error) {\n            if (true) {\n                console.error(\"Error verifying access code:\", error);\n            }\n            return false;\n        }\n        return !!data;\n    }\n    // --- Metode Foto ---\n    async getEventPhotos(eventId) {\n        const { data, error } = await this.supabase.from(\"photos\").select(\"*\").eq(\"event_id\", eventId).order(\"uploaded_at\", {\n            ascending: false\n        });\n        if (error) throw error;\n        return data;\n    }\n    async getHomepagePhotos() {\n        const { data, error } = await this.supabase.from(\"photos\").select(\"*\").eq(\"is_homepage\", true) // Asumsi kolom ini ada di tabel photos\n        .order(\"uploaded_at\", {\n            ascending: false\n        });\n        if (error) {\n            // Log error yang lebih spesifik jika kolom tidak ditemukan\n            if (error.code === \"42P01\") {\n                if (true) {\n                    console.error(\"Database Error: Column 'is_homepage' does not exist. Please add it to your 'photos' table.\");\n                }\n            }\n            throw error;\n        }\n        return data;\n    }\n    validateFileExtension(filename) {\n        const allowedExtensions = [\n            \"jpg\",\n            \"jpeg\",\n            \"png\",\n            \"gif\",\n            \"webp\"\n        ];\n        const ext = filename.split(\".\").pop()?.toLowerCase();\n        return ext ? allowedExtensions.includes(ext) : false;\n    }\n    generateFileName(originalName) {\n        const fileExt = originalName.split(\".\").pop()?.toLowerCase() || \"jpg\";\n        const timestamp = Date.now();\n        const randomStr = Math.random().toString(36).substring(2, 8);\n        return `${timestamp}_${randomStr}.${fileExt}`;\n    }\n    async getEvents() {\n        const { data, error } = await this.supabase.from(\"events\").select(\"*\").order(\"date\", {\n            ascending: false\n        });\n        if (error) throw error;\n        return data || [];\n    }\n    async getSimpleCompressionAnalytics() {\n        try {\n            // Get photos with compression data (simplified version)\n            const { data: photos, error: photosError } = await this.supabase.from(\"photos\").select(\"*\").not(\"optimized_images\", \"is\", null).order(\"uploaded_at\", {\n                ascending: false\n            }).limit(100); // Limit to recent 100 photos\n            if (photosError) throw photosError;\n            // Calculate simple analytics\n            const totalPhotos = photos?.length || 0;\n            let totalOriginalSize = 0;\n            let totalOptimizedSize = 0;\n            let totalSavingsBytes = 0;\n            const recentPhotos = [];\n            photos?.forEach((photo)=>{\n                if (photo.image_metadata && photo.optimized_images) {\n                    const originalSize = photo.image_metadata.original_size || 0;\n                    const optimizedSize = photo.optimized_images.medium?.size || 0;\n                    const savings = originalSize - optimizedSize;\n                    const savingsPercentage = originalSize > 0 ? savings / originalSize * 100 : 0;\n                    totalOriginalSize += originalSize;\n                    totalOptimizedSize += optimizedSize;\n                    totalSavingsBytes += savings;\n                    // Recent photos (top 10)\n                    if (recentPhotos.length < 10) {\n                        recentPhotos.push({\n                            id: photo.id,\n                            original_name: photo.original_name,\n                            original_size: originalSize,\n                            optimized_size: optimizedSize,\n                            savings_percentage: savingsPercentage,\n                            uploaded_at: photo.uploaded_at\n                        });\n                    }\n                }\n            });\n            const totalSavingsPercentage = totalOriginalSize > 0 ? totalSavingsBytes / totalOriginalSize * 100 : 0;\n            const averageCompressionRatio = totalOptimizedSize > 0 ? totalOriginalSize / totalOptimizedSize : 1;\n            return {\n                totalPhotos,\n                totalOriginalSize,\n                totalOptimizedSize,\n                totalSavingsBytes,\n                totalSavingsPercentage,\n                storageSaved: this.formatFileSize(totalSavingsBytes),\n                averageCompressionRatio,\n                recentPhotos: recentPhotos.sort((a, b)=>b.savings_percentage - a.savings_percentage)\n            };\n        } catch (error) {\n            console.error(\"Error getting simple compression analytics:\", error);\n            throw error;\n        }\n    }\n    formatFileSize(bytes) {\n        if (bytes === 0) return \"0 Bytes\";\n        const k = 1024;\n        const sizes = [\n            \"Bytes\",\n            \"KB\",\n            \"MB\",\n            \"GB\"\n        ];\n        const i = Math.floor(Math.log(bytes) / Math.log(k));\n        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + \" \" + sizes[i];\n    }\n    async validateEventAccess(eventId) {\n        const { data, error } = await this.supabase.from(\"events\").select(\"id, is_premium\").eq(\"id\", eventId).single();\n        if (error || !data) {\n            throw new Error(\"Event not found\");\n        }\n        return true;\n    }\n    async uploadEventPhoto(eventId, file, uploaderName = \"Anonymous\", albumName = \"Tamu\") {\n        // Validate eventId exists\n        await this.validateEventAccess(eventId);\n        // Validate file extension\n        if (!this.validateFileExtension(file.name)) {\n            throw new Error(\"Invalid file type. Allowed: jpg, jpeg, png, gif, webp\");\n        }\n        try {\n            // Convert File to Buffer for server-side processing\n            const arrayBuffer = await file.arrayBuffer();\n            const buffer = Buffer.from(arrayBuffer);\n            // Process image with optimization (server-side)\n            const optimizedImages = await this.imageOptimizer.processImage(buffer, file.name, `events/${eventId}`);\n            // Get image metadata\n            const sharp = (await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! sharp */ \"sharp\", 23))).default;\n            const metadata = await sharp(buffer).metadata();\n            const imageMetadata = {\n                width: metadata.width || 0,\n                height: metadata.height || 0,\n                format: metadata.format || \"jpeg\",\n                original_size: buffer.length\n            };\n            // Calculate compression stats\n            const compressionStats = _image_optimizer_server__WEBPACK_IMPORTED_MODULE_1__.ImageOptimizerServer.getCompressionStats(optimizedImages);\n            const { data: photoData, error: insertError } = await this.supabase.from(\"photos\").insert({\n                event_id: eventId,\n                url: optimizedImages.original.url,\n                thumbnail_url: optimizedImages.thumbnail.url,\n                original_name: file.name,\n                uploader_name: uploaderName,\n                album_name: albumName,\n                is_homepage: false,\n                filename: this.generateFileName(file.name),\n                optimized_images: optimizedImages,\n                image_metadata: imageMetadata,\n                compression_stats: compressionStats\n            }).select().single();\n            if (insertError) throw insertError;\n            return photoData;\n        } catch (error) {\n            console.error(\"Error uploading optimized event photo:\", error);\n            throw error;\n        }\n    }\n    async uploadHomepagePhoto(file) {\n        // Validate file extension\n        if (!this.validateFileExtension(file.name)) {\n            throw new Error(\"Invalid file type. Allowed: jpg, jpeg, png, gif, webp\");\n        }\n        try {\n            // Convert File to Buffer for server-side processing\n            const arrayBuffer = await file.arrayBuffer();\n            const buffer = Buffer.from(arrayBuffer);\n            // Process image with optimization (server-side)\n            const optimizedImages = await this.imageOptimizer.processImage(buffer, file.name, \"homepage\");\n            // Get image metadata\n            const sharp = (await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! sharp */ \"sharp\", 23))).default;\n            const metadata = await sharp(buffer).metadata();\n            const imageMetadata = {\n                width: metadata.width || 0,\n                height: metadata.height || 0,\n                format: metadata.format || \"jpeg\",\n                original_size: buffer.length\n            };\n            // Calculate compression stats\n            const compressionStats = _image_optimizer_server__WEBPACK_IMPORTED_MODULE_1__.ImageOptimizerServer.getCompressionStats(optimizedImages);\n            const { data: photoData, error: insertError } = await this.supabase.from(\"photos\").insert({\n                url: optimizedImages.original.url,\n                thumbnail_url: optimizedImages.thumbnail.url,\n                original_name: file.name,\n                is_homepage: true,\n                event_id: null,\n                uploader_name: \"Admin\",\n                album_name: \"Homepage\",\n                filename: this.generateFileName(file.name),\n                optimized_images: optimizedImages,\n                image_metadata: imageMetadata,\n                compression_stats: compressionStats\n            }).select().single();\n            if (insertError) throw insertError;\n            return photoData;\n        } catch (error) {\n            console.error(\"Error uploading optimized homepage photo:\", error);\n            throw error;\n        }\n    }\n    async getPhotoById(photoId) {\n        const { data, error } = await this.supabase.from(\"photos\").select(\"*\").eq(\"id\", photoId).single();\n        if (error) throw error;\n        return data;\n    }\n    async deletePhoto(photoId) {\n        // Get photo details\n        const photo = await this.getPhotoById(photoId);\n        if (!photo) {\n            throw new Error(\"Photo not found\");\n        }\n        try {\n            // Extract file path from URL or use stored filename\n            let filePath;\n            if (photo.filename) {\n                // Use stored filename if available\n                if (photo.is_homepage) {\n                    filePath = `homepage/${photo.filename}`;\n                } else if (photo.event_id) {\n                    filePath = `events/${photo.event_id}/${photo.filename}`;\n                } else {\n                    // Fallback if structure is unclear\n                    filePath = photo.filename;\n                }\n            } else {\n                // Extract from URL as fallback\n                const urlParts = photo.url.split(\"/\");\n                const fileName = urlParts[urlParts.length - 1];\n                if (photo.is_homepage) {\n                    filePath = `homepage/${fileName}`;\n                } else if (photo.event_id) {\n                    filePath = `events/${photo.event_id}/${fileName}`;\n                } else {\n                    // Fallback if structure is unclear\n                    filePath = fileName;\n                }\n            }\n            // Delete from storage first\n            const { error: deleteStorageError } = await this.supabase.storage.from(\"photos\").remove([\n                filePath\n            ]);\n            if (deleteStorageError) {\n                if (true) {\n                    console.error(\"Error deleting file from storage:\", deleteStorageError);\n                }\n            // Continue with database deletion even if storage deletion fails\n            }\n            // Then delete from database\n            const { error: deleteDbError } = await this.supabase.from(\"photos\").delete().eq(\"id\", photoId);\n            if (deleteDbError) throw deleteDbError;\n        } catch (error) {\n            // If it's not a storage error, rethrow\n            if (error instanceof Error && !error.message.includes(\"storage\")) {\n                throw error;\n            }\n            // For storage errors, try to delete from database anyway\n            const { error: deleteDbError } = await this.supabase.from(\"photos\").delete().eq(\"id\", photoId);\n            if (deleteDbError) throw deleteDbError;\n        }\n    }\n    async likePhoto(photoId) {\n        const { data, error } = await this.supabase.rpc(\"increment_likes\", {\n            photo_id: photoId\n        }); // Panggil fungsi RPC\n        if (error) throw error;\n    }\n    // --- Metode Pesan ---\n    async getEventMessages(eventId) {\n        const { data, error } = await this.supabase.from(\"messages\").select(\"*\").eq(\"event_id\", eventId).order(\"sent_at\", {\n            ascending: false\n        });\n        if (error) throw error;\n        return data;\n    }\n    async createMessage(message) {\n        const { data, error } = await this.supabase.from(\"messages\").insert(message).select().single();\n        if (error) throw error;\n        return data;\n    }\n    async heartMessage(messageId) {\n        const { data, error } = await this.supabase.rpc(\"increment_hearts\", {\n            message_id: messageId\n        }); // Panggil fungsi RPC\n        if (error) throw error;\n    }\n    async getMessageById(messageId) {\n        const { data, error } = await this.supabase.from(\"messages\").select(\"*\").eq(\"id\", messageId).single();\n        if (error) throw error;\n        return data;\n    }\n    async updateMessageHearts(messageId, hearts) {\n        const { error } = await this.supabase.from(\"messages\").update({\n            hearts\n        }).eq(\"id\", messageId);\n        if (error) throw error;\n    }\n    async addMessageReaction(messageId, reactionType) {\n        // Get current message\n        const message = await this.getMessageById(messageId);\n        if (!message) {\n            throw new Error(\"Message not found\");\n        }\n        // Get current reactions or initialize\n        const currentReactions = message.reactions || {\n            love: 0,\n            laugh: 0,\n            wow: 0,\n            sad: 0,\n            angry: 0\n        };\n        // Increment the specific reaction\n        currentReactions[reactionType] = (currentReactions[reactionType] || 0) + 1;\n        // Update in database\n        const { error } = await this.supabase.from(\"messages\").update({\n            reactions: currentReactions\n        }).eq(\"id\", messageId);\n        if (error) throw error;\n    }\n    async updateMessageReactions(messageId, reactions) {\n        const { error } = await this.supabase.from(\"messages\").update({\n            reactions\n        }).eq(\"id\", messageId);\n        if (error) throw error;\n    }\n    // --- Metode Statistik ---\n    async getStats() {\n        const { count: totalEvents, error: eventsError } = await this.supabase.from(\"events\").select(\"*\", {\n            count: \"exact\",\n            head: true\n        });\n        if (eventsError) throw eventsError;\n        const { count: totalPhotos, error: photosError } = await this.supabase.from(\"photos\").select(\"*\", {\n            count: \"exact\",\n            head: true\n        });\n        if (photosError) throw photosError;\n        const { count: totalMessages, error: messagesError } = await this.supabase.from(\"messages\").select(\"*\", {\n            count: \"exact\",\n            head: true\n        });\n        if (messagesError) throw messagesError;\n        return {\n            totalEvents: totalEvents || 0,\n            totalPhotos: totalPhotos || 0,\n            totalMessages: totalMessages || 0\n        };\n    }\n}\nconst database = new DatabaseService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RTJHLE9BQU9JLGFBQWEsRUFBRTNLLE9BQU80SyxhQUFhLEVBQUUsR0FBRyxNQUFNLElBQUksQ0FBQ2hMLFFBQVEsQ0FDdkVLLElBQUksQ0FBQyxZQUNMQyxNQUFNLENBQUMsS0FBSztZQUFFcUssT0FBTztZQUFTRyxNQUFNO1FBQUs7UUFDNUMsSUFBSUUsZUFBZSxNQUFNQTtRQUV6QixPQUFPO1lBQ0xKLGFBQWFBLGVBQWU7WUFDNUJ6RyxhQUFhQSxlQUFlO1lBQzVCNEcsZUFBZUEsaUJBQWlCO1FBQ2xDO0lBQ0Y7QUFDRjtBQUVPLE1BQU1FLFdBQVcsSUFBSW5MLGtCQUFrQiIsInNvdXJjZXMiOlsid2VicGFjazovL2hhZmlwb3J0cmFpdC1uZXh0anMvLi9zcmMvbGliL2RhdGFiYXNlLnRzP2MxYjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gJy4vc3VwYWJhc2UnOyAvLyBQYXN0aWthbiBpbmkgZGlpbXBvciBkZW5nYW4gYmVuYXJcbmltcG9ydCB7IEltYWdlT3B0aW1pemVyU2VydmVyIH0gZnJvbSAnLi9pbWFnZS1vcHRpbWl6ZXItc2VydmVyJztcblxuLy8gRGVmaW5pc2kgVGlwZSBEYXRhIHVudHVrIGtvbnNpc3RlbnNpXG5leHBvcnQgdHlwZSBFdmVudCA9IHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBkYXRlOiBzdHJpbmc7XG4gIGFjY2Vzc19jb2RlOiBzdHJpbmcgfCBudWxsO1xuICBpc19wcmVtaXVtOiBib29sZWFuO1xuICBxcl9jb2RlOiBzdHJpbmcgfCBudWxsO1xuICBzaGFyZWFibGVfbGluazogc3RyaW5nIHwgbnVsbDtcbn07XG5cbmV4cG9ydCB0eXBlIFBob3RvID0ge1xuICBpZDogc3RyaW5nO1xuICBldmVudF9pZD86IHN0cmluZyB8IG51bGw7IC8vIE9wc2lvbmFsIGthcmVuYSBiaXNhIGphZGkgZm90byBob21lcGFnZVxuICB1cmw6IHN0cmluZztcbiAgdGh1bWJuYWlsX3VybDogc3RyaW5nIHwgbnVsbDtcbiAgdXBsb2FkZWRfYXQ6IHN0cmluZztcbiAgaXNfaG9tZXBhZ2U6IGJvb2xlYW4gfCBudWxsOyAvLyBUYW1iYWhrYW4gaW5pIGppa2EgYmVsdW0gYWRhXG4gIG9yaWdpbmFsX25hbWU6IHN0cmluZztcbiAgdXBsb2FkZXJfbmFtZT86IHN0cmluZyB8IG51bGw7XG4gIGFsYnVtX25hbWU/OiBzdHJpbmcgfCBudWxsO1xuICBmaWxlbmFtZT86IHN0cmluZyB8IG51bGw7IC8vIFRhbWJhaGthbiBmaWxlbmFtZSBqaWthIHJlcXVpcmVkXG4gIG9wdGltaXplZF9pbWFnZXM/OiBPcHRpbWl6ZWRJbWFnZXMgfCBudWxsO1xuICBpbWFnZV9tZXRhZGF0YT86IEltYWdlTWV0YWRhdGEgfCBudWxsO1xuICBjb21wcmVzc2lvbl9zdGF0cz86IENvbXByZXNzaW9uU3RhdHMgfCBudWxsO1xufTtcblxuZXhwb3J0IHR5cGUgT3B0aW1pemVkSW1hZ2VzID0ge1xuICBvcmlnaW5hbDogeyB1cmw6IHN0cmluZzsgc2l6ZTogbnVtYmVyOyB3aWR0aD86IG51bWJlcjsgaGVpZ2h0PzogbnVtYmVyOyB9O1xuICB0aHVtYm5haWw6IHsgdXJsOiBzdHJpbmc7IHNpemU6IG51bWJlcjsgfTtcbiAgc21hbGw6IHsgdXJsOiBzdHJpbmc7IHNpemU6IG51bWJlcjsgfTtcbiAgbWVkaXVtOiB7IHVybDogc3RyaW5nOyBzaXplOiBudW1iZXI7IH07XG4gIGxhcmdlOiB7IHVybDogc3RyaW5nOyBzaXplOiBudW1iZXI7IH07XG59O1xuXG5leHBvcnQgdHlwZSBJbWFnZU1ldGFkYXRhID0ge1xuICB3aWR0aDogbnVtYmVyO1xuICBoZWlnaHQ6IG51bWJlcjtcbiAgZm9ybWF0OiBzdHJpbmc7XG4gIG9yaWdpbmFsX3NpemU6IG51bWJlcjtcbn07XG5cbmV4cG9ydCB0eXBlIENvbXByZXNzaW9uU3RhdHMgPSB7XG4gIG9yaWdpbmFsX3NpemU6IHN0cmluZztcbiAgb3B0aW1pemVkX3NpemU6IHN0cmluZztcbiAgc2F2aW5nczogbnVtYmVyO1xuICByYXRpbzogc3RyaW5nO1xufTtcblxuZXhwb3J0IHR5cGUgTWVzc2FnZVJlYWN0aW9ucyA9IHtcbiAgbG92ZTogbnVtYmVyO1xuICBsYXVnaDogbnVtYmVyO1xuICB3b3c6IG51bWJlcjtcbiAgc2FkOiBudW1iZXI7XG4gIGFuZ3J5OiBudW1iZXI7XG59O1xuXG5leHBvcnQgdHlwZSBNZXNzYWdlID0ge1xuICBpZDogc3RyaW5nO1xuICBldmVudF9pZDogc3RyaW5nO1xuICBzZW5kZXJfbmFtZTogc3RyaW5nO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIHNlbnRfYXQ6IHN0cmluZztcbiAgaGVhcnRzOiBudW1iZXI7XG4gIHJlYWN0aW9ucz86IE1lc3NhZ2VSZWFjdGlvbnM7XG4gIGd1ZXN0X25hbWU/OiBzdHJpbmc7IC8vIEFkZCBndWVzdF9uYW1lIGFzIG9wdGlvbmFsIGZvciBjb21wYXRpYmlsaXR5XG59O1xuXG5leHBvcnQgdHlwZSBTdGF0cyA9IHtcbiAgdG90YWxFdmVudHM6IG51bWJlcjtcbiAgdG90YWxQaG90b3M6IG51bWJlcjtcbiAgdG90YWxNZXNzYWdlczogbnVtYmVyO1xufTtcblxuY2xhc3MgRGF0YWJhc2VTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBzdXBhYmFzZTogdHlwZW9mIHN1cGFiYXNlQWRtaW47XG4gIHByaXZhdGUgaW1hZ2VPcHRpbWl6ZXI6IEltYWdlT3B0aW1pemVyU2VydmVyO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc3VwYWJhc2UgPSBzdXBhYmFzZUFkbWluO1xuICAgIHRoaXMuaW1hZ2VPcHRpbWl6ZXIgPSBuZXcgSW1hZ2VPcHRpbWl6ZXJTZXJ2ZXIodGhpcy5zdXBhYmFzZSwgJ3Bob3RvcycpO1xuICB9XG5cbiAgLy8gLS0tIE1ldG9kZSBFdmVudCAtLS1cbiAgYXN5bmMgZ2V0QWxsRXZlbnRzKCk6IFByb21pc2U8RXZlbnRbXT4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdldmVudHMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAub3JkZXIoJ2RhdGUnLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIGFzeW5jIGdldFB1YmxpY0V2ZW50cygpOiBQcm9taXNlPEV2ZW50W10+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgnZXZlbnRzJylcbiAgICAgIC5zZWxlY3QoJ2lkLCBuYW1lLCBkYXRlLCBpc19wcmVtaXVtLCBxcl9jb2RlLCBzaGFyZWFibGVfbGluaycpXG4gICAgICAuaXMoJ2lzX3ByZW1pdW0nLCBmYWxzZSkgLy8gQXN1bXNpIGhhbnlhIGV2ZW50IG5vbi1wcmVtaXVtIHlhbmcgcHVibGlrLCBzZXN1YWlrYW4gamlrYSBwZXJsdVxuICAgICAgLm9yZGVyKCdkYXRlJywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pO1xuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cblxuICBhc3luYyBnZXRFdmVudEJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8RXZlbnQgfCBudWxsPiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ2V2ZW50cycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnaWQnLCBpZClcbiAgICAgIC5zaW5nbGUoKTtcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgYXN5bmMgY3JlYXRlRXZlbnQoZXZlbnQ6IE9taXQ8RXZlbnQsICdpZCcgfCAncXJfY29kZScgfCAnc2hhcmVhYmxlX2xpbmsnPik6IFByb21pc2U8RXZlbnQ+IHtcbiAgICAvLyBGaXJzdCwgaW5zZXJ0IHRoZSBldmVudCB0byBnZXQgdGhlIElEXG4gICAgY29uc3QgeyBkYXRhOiBuZXdFdmVudCwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdldmVudHMnKVxuICAgICAgLmluc2VydChldmVudClcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpO1xuICAgIFxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIC8vIEdlbmVyYXRlIFFSIGNvZGUgYW5kIHNoYXJlYWJsZSBsaW5rXG4gICAgICBjb25zdCBiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBQX1VSTCB8fCAnaHR0cDovL2xvY2FsaG9zdDozMDAwJztcbiAgICAgIGNvbnN0IGV2ZW50VXJsID0gYCR7YmFzZVVybH0vZXZlbnQvJHtuZXdFdmVudC5pZH0/Y29kZT0ke25ld0V2ZW50LmFjY2Vzc19jb2RlfWA7XG4gICAgICBcbiAgICAgIC8vIEdlbmVyYXRlIFFSIGNvZGUgdXNpbmcgYSBzZXJ2aWNlIGxpa2UgUVJTZXJ2ZXIuY29tXG4gICAgICBjb25zdCBxckNvZGVVcmwgPSBgaHR0cHM6Ly9hcGkucXJzZXJ2ZXIuY29tL3YxL2NyZWF0ZS1xci1jb2RlLz9zaXplPTMwMHgzMDAmZGF0YT0ke2VuY29kZVVSSUNvbXBvbmVudChldmVudFVybCl9YDtcbiAgICAgIFxuICAgICAgLy8gVXBkYXRlIHRoZSBldmVudCB3aXRoIFFSIGNvZGUgYW5kIHNoYXJlYWJsZSBsaW5rXG4gICAgICBjb25zdCB7IGRhdGE6IHVwZGF0ZWRFdmVudCwgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdldmVudHMnKVxuICAgICAgICAudXBkYXRlKHtcbiAgICAgICAgICBxcl9jb2RlOiBxckNvZGVVcmwsXG4gICAgICAgICAgc2hhcmVhYmxlX2xpbms6IGV2ZW50VXJsXG4gICAgICAgIH0pXG4gICAgICAgIC5lcSgnaWQnLCBuZXdFdmVudC5pZClcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKTtcbiAgICAgIFxuICAgICAgaWYgKHVwZGF0ZUVycm9yKSB0aHJvdyB1cGRhdGVFcnJvcjtcbiAgICAgIHJldHVybiB1cGRhdGVkRXZlbnQ7XG4gICAgfSBjYXRjaCAodXBkYXRlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgUVIgY29kZTonLCB1cGRhdGVFcnJvcik7XG4gICAgICAvLyBSZXR1cm4gdGhlIGV2ZW50IGV2ZW4gaWYgUVIgY29kZSBnZW5lcmF0aW9uIGZhaWxzXG4gICAgICByZXR1cm4gbmV3RXZlbnQ7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgdXBkYXRlRXZlbnQoaWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxFdmVudD4pOiBQcm9taXNlPEV2ZW50PiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ2V2ZW50cycpXG4gICAgICAudXBkYXRlKHVwZGF0ZXMpXG4gICAgICAuZXEoJ2lkJywgaWQpXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKTtcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgYXN5bmMgZGVsZXRlRXZlbnQoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdldmVudHMnKVxuICAgICAgLmRlbGV0ZSgpXG4gICAgICAuZXEoJ2lkJywgaWQpO1xuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gIH1cblxuICBhc3luYyB2ZXJpZnlFdmVudEFjY2Vzc0NvZGUoZXZlbnRJZDogc3RyaW5nLCBjb2RlOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgnZXZlbnRzJylcbiAgICAgIC5zZWxlY3QoJ2lkJylcbiAgICAgIC5lcSgnaWQnLCBldmVudElkKVxuICAgICAgLmVxKCdhY2Nlc3NfY29kZScsIGNvZGUpXG4gICAgICAuc2luZ2xlKCk7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdmVyaWZ5aW5nIGFjY2VzcyBjb2RlOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuICEhZGF0YTtcbiAgfVxuXG4gIC8vIC0tLSBNZXRvZGUgRm90byAtLS1cbiAgYXN5bmMgZ2V0RXZlbnRQaG90b3MoZXZlbnRJZDogc3RyaW5nKTogUHJvbWlzZTxQaG90b1tdPiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ3Bob3RvcycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnZXZlbnRfaWQnLCBldmVudElkKVxuICAgICAgLm9yZGVyKCd1cGxvYWRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgYXN5bmMgZ2V0SG9tZXBhZ2VQaG90b3MoKTogUHJvbWlzZTxQaG90b1tdPiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ3Bob3RvcycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnaXNfaG9tZXBhZ2UnLCB0cnVlKSAvLyBBc3Vtc2kga29sb20gaW5pIGFkYSBkaSB0YWJlbCBwaG90b3NcbiAgICAgIC5vcmRlcigndXBsb2FkZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICAvLyBMb2cgZXJyb3IgeWFuZyBsZWJpaCBzcGVzaWZpayBqaWthIGtvbG9tIHRpZGFrIGRpdGVtdWthblxuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICc0MlAwMScpIHsgLy8gUG9zdGdyZVNRTCBlcnJvciBjb2RlIGZvciB1bmRlZmluZWRfdGFibGVcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIkRhdGFiYXNlIEVycm9yOiBDb2x1bW4gJ2lzX2hvbWVwYWdlJyBkb2VzIG5vdCBleGlzdC4gUGxlYXNlIGFkZCBpdCB0byB5b3VyICdwaG90b3MnIHRhYmxlLlwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgcHJpdmF0ZSB2YWxpZGF0ZUZpbGVFeHRlbnNpb24oZmlsZW5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGFsbG93ZWRFeHRlbnNpb25zID0gWydqcGcnLCAnanBlZycsICdwbmcnLCAnZ2lmJywgJ3dlYnAnXTtcbiAgICBjb25zdCBleHQgPSBmaWxlbmFtZS5zcGxpdCgnLicpLnBvcCgpPy50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiBleHQgPyBhbGxvd2VkRXh0ZW5zaW9ucy5pbmNsdWRlcyhleHQpIDogZmFsc2U7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlRmlsZU5hbWUob3JpZ2luYWxOYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGZpbGVFeHQgPSBvcmlnaW5hbE5hbWUuc3BsaXQoJy4nKS5wb3AoKT8udG9Mb3dlckNhc2UoKSB8fCAnanBnJztcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHJhbmRvbVN0ciA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCA4KTtcbiAgICByZXR1cm4gYCR7dGltZXN0YW1wfV8ke3JhbmRvbVN0cn0uJHtmaWxlRXh0fWA7XG4gIH1cblxuICBhc3luYyBnZXRFdmVudHMoKTogUHJvbWlzZTxFdmVudFtdPiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ2V2ZW50cycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5vcmRlcignZGF0ZScsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcbiAgICBcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICAgIHJldHVybiBkYXRhIHx8IFtdO1xuICB9XG5cbiAgYXN5bmMgZ2V0U2ltcGxlQ29tcHJlc3Npb25BbmFseXRpY3MoKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCBwaG90b3Mgd2l0aCBjb21wcmVzc2lvbiBkYXRhIChzaW1wbGlmaWVkIHZlcnNpb24pXG4gICAgICBjb25zdCB7IGRhdGE6IHBob3RvcywgZXJyb3I6IHBob3Rvc0Vycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwaG90b3MnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLm5vdCgnb3B0aW1pemVkX2ltYWdlcycsICdpcycsIG51bGwpXG4gICAgICAgIC5vcmRlcigndXBsb2FkZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgICAgLmxpbWl0KDEwMCk7IC8vIExpbWl0IHRvIHJlY2VudCAxMDAgcGhvdG9zXG5cbiAgICAgIGlmIChwaG90b3NFcnJvcikgdGhyb3cgcGhvdG9zRXJyb3I7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBzaW1wbGUgYW5hbHl0aWNzXG4gICAgICBjb25zdCB0b3RhbFBob3RvcyA9IHBob3Rvcz8ubGVuZ3RoIHx8IDA7XG4gICAgICBsZXQgdG90YWxPcmlnaW5hbFNpemUgPSAwO1xuICAgICAgbGV0IHRvdGFsT3B0aW1pemVkU2l6ZSA9IDA7XG4gICAgICBsZXQgdG90YWxTYXZpbmdzQnl0ZXMgPSAwO1xuXG4gICAgICBjb25zdCByZWNlbnRQaG90b3M6IGFueVtdID0gW107XG5cbiAgICAgIHBob3Rvcz8uZm9yRWFjaChwaG90byA9PiB7XG4gICAgICAgIGlmIChwaG90by5pbWFnZV9tZXRhZGF0YSAmJiBwaG90by5vcHRpbWl6ZWRfaW1hZ2VzKSB7XG4gICAgICAgICAgY29uc3Qgb3JpZ2luYWxTaXplID0gcGhvdG8uaW1hZ2VfbWV0YWRhdGEub3JpZ2luYWxfc2l6ZSB8fCAwO1xuICAgICAgICAgIGNvbnN0IG9wdGltaXplZFNpemUgPSBwaG90by5vcHRpbWl6ZWRfaW1hZ2VzLm1lZGl1bT8uc2l6ZSB8fCAwO1xuICAgICAgICAgIGNvbnN0IHNhdmluZ3MgPSBvcmlnaW5hbFNpemUgLSBvcHRpbWl6ZWRTaXplO1xuICAgICAgICAgIGNvbnN0IHNhdmluZ3NQZXJjZW50YWdlID0gb3JpZ2luYWxTaXplID4gMCA/IChzYXZpbmdzIC8gb3JpZ2luYWxTaXplKSAqIDEwMCA6IDA7XG5cbiAgICAgICAgICB0b3RhbE9yaWdpbmFsU2l6ZSArPSBvcmlnaW5hbFNpemU7XG4gICAgICAgICAgdG90YWxPcHRpbWl6ZWRTaXplICs9IG9wdGltaXplZFNpemU7XG4gICAgICAgICAgdG90YWxTYXZpbmdzQnl0ZXMgKz0gc2F2aW5ncztcblxuICAgICAgICAgIC8vIFJlY2VudCBwaG90b3MgKHRvcCAxMClcbiAgICAgICAgICBpZiAocmVjZW50UGhvdG9zLmxlbmd0aCA8IDEwKSB7XG4gICAgICAgICAgICByZWNlbnRQaG90b3MucHVzaCh7XG4gICAgICAgICAgICAgIGlkOiBwaG90by5pZCxcbiAgICAgICAgICAgICAgb3JpZ2luYWxfbmFtZTogcGhvdG8ub3JpZ2luYWxfbmFtZSxcbiAgICAgICAgICAgICAgb3JpZ2luYWxfc2l6ZTogb3JpZ2luYWxTaXplLFxuICAgICAgICAgICAgICBvcHRpbWl6ZWRfc2l6ZTogb3B0aW1pemVkU2l6ZSxcbiAgICAgICAgICAgICAgc2F2aW5nc19wZXJjZW50YWdlOiBzYXZpbmdzUGVyY2VudGFnZSxcbiAgICAgICAgICAgICAgdXBsb2FkZWRfYXQ6IHBob3RvLnVwbG9hZGVkX2F0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB0b3RhbFNhdmluZ3NQZXJjZW50YWdlID0gdG90YWxPcmlnaW5hbFNpemUgPiAwID8gKHRvdGFsU2F2aW5nc0J5dGVzIC8gdG90YWxPcmlnaW5hbFNpemUpICogMTAwIDogMDtcbiAgICAgIGNvbnN0IGF2ZXJhZ2VDb21wcmVzc2lvblJhdGlvID0gdG90YWxPcHRpbWl6ZWRTaXplID4gMCA/IHRvdGFsT3JpZ2luYWxTaXplIC8gdG90YWxPcHRpbWl6ZWRTaXplIDogMTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdG90YWxQaG90b3MsXG4gICAgICAgIHRvdGFsT3JpZ2luYWxTaXplLFxuICAgICAgICB0b3RhbE9wdGltaXplZFNpemUsXG4gICAgICAgIHRvdGFsU2F2aW5nc0J5dGVzLFxuICAgICAgICB0b3RhbFNhdmluZ3NQZXJjZW50YWdlLFxuICAgICAgICBzdG9yYWdlU2F2ZWQ6IHRoaXMuZm9ybWF0RmlsZVNpemUodG90YWxTYXZpbmdzQnl0ZXMpLFxuICAgICAgICBhdmVyYWdlQ29tcHJlc3Npb25SYXRpbyxcbiAgICAgICAgcmVjZW50UGhvdG9zOiByZWNlbnRQaG90b3Muc29ydCgoYSwgYikgPT4gYi5zYXZpbmdzX3BlcmNlbnRhZ2UgLSBhLnNhdmluZ3NfcGVyY2VudGFnZSlcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgc2ltcGxlIGNvbXByZXNzaW9uIGFuYWx5dGljczonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGZvcm1hdEZpbGVTaXplKGJ5dGVzOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGlmIChieXRlcyA9PT0gMCkgcmV0dXJuICcwIEJ5dGVzJztcbiAgICBjb25zdCBrID0gMTAyNDtcbiAgICBjb25zdCBzaXplcyA9IFsnQnl0ZXMnLCAnS0InLCAnTUInLCAnR0InXTtcbiAgICBjb25zdCBpID0gTWF0aC5mbG9vcihNYXRoLmxvZyhieXRlcykgLyBNYXRoLmxvZyhrKSk7XG4gICAgcmV0dXJuIHBhcnNlRmxvYXQoKGJ5dGVzIC8gTWF0aC5wb3coaywgaSkpLnRvRml4ZWQoMikpICsgJyAnICsgc2l6ZXNbaV07XG4gIH1cblxuICBhc3luYyB2YWxpZGF0ZUV2ZW50QWNjZXNzKGV2ZW50SWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdldmVudHMnKVxuICAgICAgLnNlbGVjdCgnaWQsIGlzX3ByZW1pdW0nKVxuICAgICAgLmVxKCdpZCcsIGV2ZW50SWQpXG4gICAgICAuc2luZ2xlKCk7XG4gICAgXG4gICAgaWYgKGVycm9yIHx8ICFkYXRhKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V2ZW50IG5vdCBmb3VuZCcpO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGFzeW5jIHVwbG9hZEV2ZW50UGhvdG8oZXZlbnRJZDogc3RyaW5nLCBmaWxlOiBGaWxlLCB1cGxvYWRlck5hbWU6IHN0cmluZyA9ICdBbm9ueW1vdXMnLCBhbGJ1bU5hbWU6IHN0cmluZyA9ICdUYW11Jyk6IFByb21pc2U8UGhvdG8+IHtcbiAgICAvLyBWYWxpZGF0ZSBldmVudElkIGV4aXN0c1xuICAgIGF3YWl0IHRoaXMudmFsaWRhdGVFdmVudEFjY2VzcyhldmVudElkKTtcblxuICAgIC8vIFZhbGlkYXRlIGZpbGUgZXh0ZW5zaW9uXG4gICAgaWYgKCF0aGlzLnZhbGlkYXRlRmlsZUV4dGVuc2lvbihmaWxlLm5hbWUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgZmlsZSB0eXBlLiBBbGxvd2VkOiBqcGcsIGpwZWcsIHBuZywgZ2lmLCB3ZWJwJyk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIENvbnZlcnQgRmlsZSB0byBCdWZmZXIgZm9yIHNlcnZlci1zaWRlIHByb2Nlc3NpbmdcbiAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgZmlsZS5hcnJheUJ1ZmZlcigpO1xuICAgICAgY29uc3QgYnVmZmVyID0gQnVmZmVyLmZyb20oYXJyYXlCdWZmZXIpO1xuICAgICAgXG4gICAgICAvLyBQcm9jZXNzIGltYWdlIHdpdGggb3B0aW1pemF0aW9uIChzZXJ2ZXItc2lkZSlcbiAgICAgIGNvbnN0IG9wdGltaXplZEltYWdlcyA9IGF3YWl0IHRoaXMuaW1hZ2VPcHRpbWl6ZXIucHJvY2Vzc0ltYWdlKGJ1ZmZlciwgZmlsZS5uYW1lLCBgZXZlbnRzLyR7ZXZlbnRJZH1gKTtcbiAgICAgIFxuICAgICAgLy8gR2V0IGltYWdlIG1ldGFkYXRhXG4gICAgICBjb25zdCBzaGFycCA9IChhd2FpdCBpbXBvcnQoJ3NoYXJwJykpLmRlZmF1bHQ7XG4gICAgICBjb25zdCBtZXRhZGF0YSA9IGF3YWl0IHNoYXJwKGJ1ZmZlcikubWV0YWRhdGEoKTtcbiAgICAgIFxuICAgICAgY29uc3QgaW1hZ2VNZXRhZGF0YSA9IHtcbiAgICAgICAgd2lkdGg6IG1ldGFkYXRhLndpZHRoIHx8IDAsXG4gICAgICAgIGhlaWdodDogbWV0YWRhdGEuaGVpZ2h0IHx8IDAsXG4gICAgICAgIGZvcm1hdDogbWV0YWRhdGEuZm9ybWF0IHx8ICdqcGVnJyxcbiAgICAgICAgb3JpZ2luYWxfc2l6ZTogYnVmZmVyLmxlbmd0aFxuICAgICAgfTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIGNvbXByZXNzaW9uIHN0YXRzXG4gICAgICBjb25zdCBjb21wcmVzc2lvblN0YXRzID0gSW1hZ2VPcHRpbWl6ZXJTZXJ2ZXIuZ2V0Q29tcHJlc3Npb25TdGF0cyhvcHRpbWl6ZWRJbWFnZXMpO1xuXG4gICAgICBjb25zdCB7IGRhdGE6IHBob3RvRGF0YSwgZXJyb3I6IGluc2VydEVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwaG90b3MnKVxuICAgICAgICAuaW5zZXJ0KHsgXG4gICAgICAgICAgZXZlbnRfaWQ6IGV2ZW50SWQsXG4gICAgICAgICAgdXJsOiBvcHRpbWl6ZWRJbWFnZXMub3JpZ2luYWwudXJsLCAvLyBLZWVwIG9yaWdpbmFsIFVSTCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuICAgICAgICAgIHRodW1ibmFpbF91cmw6IG9wdGltaXplZEltYWdlcy50aHVtYm5haWwudXJsLFxuICAgICAgICAgIG9yaWdpbmFsX25hbWU6IGZpbGUubmFtZSxcbiAgICAgICAgICB1cGxvYWRlcl9uYW1lOiB1cGxvYWRlck5hbWUsXG4gICAgICAgICAgYWxidW1fbmFtZTogYWxidW1OYW1lLFxuICAgICAgICAgIGlzX2hvbWVwYWdlOiBmYWxzZSxcbiAgICAgICAgICBmaWxlbmFtZTogdGhpcy5nZW5lcmF0ZUZpbGVOYW1lKGZpbGUubmFtZSksXG4gICAgICAgICAgb3B0aW1pemVkX2ltYWdlczogb3B0aW1pemVkSW1hZ2VzLFxuICAgICAgICAgIGltYWdlX21ldGFkYXRhOiBpbWFnZU1ldGFkYXRhLFxuICAgICAgICAgIGNvbXByZXNzaW9uX3N0YXRzOiBjb21wcmVzc2lvblN0YXRzXG4gICAgICAgIH0pXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKCk7XG5cbiAgICAgIGlmIChpbnNlcnRFcnJvcikgdGhyb3cgaW5zZXJ0RXJyb3I7XG4gICAgICByZXR1cm4gcGhvdG9EYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGxvYWRpbmcgb3B0aW1pemVkIGV2ZW50IHBob3RvOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHVwbG9hZEhvbWVwYWdlUGhvdG8oZmlsZTogRmlsZSk6IFByb21pc2U8UGhvdG8+IHtcbiAgICAvLyBWYWxpZGF0ZSBmaWxlIGV4dGVuc2lvblxuICAgIGlmICghdGhpcy52YWxpZGF0ZUZpbGVFeHRlbnNpb24oZmlsZS5uYW1lKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGZpbGUgdHlwZS4gQWxsb3dlZDoganBnLCBqcGVnLCBwbmcsIGdpZiwgd2VicCcpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBDb252ZXJ0IEZpbGUgdG8gQnVmZmVyIGZvciBzZXJ2ZXItc2lkZSBwcm9jZXNzaW5nXG4gICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IGZpbGUuYXJyYXlCdWZmZXIoKTtcbiAgICAgIGNvbnN0IGJ1ZmZlciA9IEJ1ZmZlci5mcm9tKGFycmF5QnVmZmVyKTtcbiAgICAgIFxuICAgICAgLy8gUHJvY2VzcyBpbWFnZSB3aXRoIG9wdGltaXphdGlvbiAoc2VydmVyLXNpZGUpXG4gICAgICBjb25zdCBvcHRpbWl6ZWRJbWFnZXMgPSBhd2FpdCB0aGlzLmltYWdlT3B0aW1pemVyLnByb2Nlc3NJbWFnZShidWZmZXIsIGZpbGUubmFtZSwgJ2hvbWVwYWdlJyk7XG4gICAgICBcbiAgICAgIC8vIEdldCBpbWFnZSBtZXRhZGF0YVxuICAgICAgY29uc3Qgc2hhcnAgPSAoYXdhaXQgaW1wb3J0KCdzaGFycCcpKS5kZWZhdWx0O1xuICAgICAgY29uc3QgbWV0YWRhdGEgPSBhd2FpdCBzaGFycChidWZmZXIpLm1ldGFkYXRhKCk7XG4gICAgICBcbiAgICAgIGNvbnN0IGltYWdlTWV0YWRhdGEgPSB7XG4gICAgICAgIHdpZHRoOiBtZXRhZGF0YS53aWR0aCB8fCAwLFxuICAgICAgICBoZWlnaHQ6IG1ldGFkYXRhLmhlaWdodCB8fCAwLFxuICAgICAgICBmb3JtYXQ6IG1ldGFkYXRhLmZvcm1hdCB8fCAnanBlZycsXG4gICAgICAgIG9yaWdpbmFsX3NpemU6IGJ1ZmZlci5sZW5ndGhcbiAgICAgIH07XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBjb21wcmVzc2lvbiBzdGF0c1xuICAgICAgY29uc3QgY29tcHJlc3Npb25TdGF0cyA9IEltYWdlT3B0aW1pemVyU2VydmVyLmdldENvbXByZXNzaW9uU3RhdHMob3B0aW1pemVkSW1hZ2VzKTtcblxuICAgICAgY29uc3QgeyBkYXRhOiBwaG90b0RhdGEsIGVycm9yOiBpbnNlcnRFcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgICAuZnJvbSgncGhvdG9zJylcbiAgICAgICAgLmluc2VydCh7IFxuICAgICAgICAgIHVybDogb3B0aW1pemVkSW1hZ2VzLm9yaWdpbmFsLnVybCwgLy8gS2VlcCBvcmlnaW5hbCBVUkwgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbiAgICAgICAgICB0aHVtYm5haWxfdXJsOiBvcHRpbWl6ZWRJbWFnZXMudGh1bWJuYWlsLnVybCxcbiAgICAgICAgICBvcmlnaW5hbF9uYW1lOiBmaWxlLm5hbWUsXG4gICAgICAgICAgaXNfaG9tZXBhZ2U6IHRydWUsXG4gICAgICAgICAgZXZlbnRfaWQ6IG51bGwsXG4gICAgICAgICAgdXBsb2FkZXJfbmFtZTogJ0FkbWluJyxcbiAgICAgICAgICBhbGJ1bV9uYW1lOiAnSG9tZXBhZ2UnLFxuICAgICAgICAgIGZpbGVuYW1lOiB0aGlzLmdlbmVyYXRlRmlsZU5hbWUoZmlsZS5uYW1lKSxcbiAgICAgICAgICBvcHRpbWl6ZWRfaW1hZ2VzOiBvcHRpbWl6ZWRJbWFnZXMsXG4gICAgICAgICAgaW1hZ2VfbWV0YWRhdGE6IGltYWdlTWV0YWRhdGEsXG4gICAgICAgICAgY29tcHJlc3Npb25fc3RhdHM6IGNvbXByZXNzaW9uU3RhdHNcbiAgICAgICAgfSlcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgaWYgKGluc2VydEVycm9yKSB0aHJvdyBpbnNlcnRFcnJvcjtcbiAgICAgIHJldHVybiBwaG90b0RhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwbG9hZGluZyBvcHRpbWl6ZWQgaG9tZXBhZ2UgcGhvdG86JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cblxuICBhc3luYyBnZXRQaG90b0J5SWQocGhvdG9JZDogc3RyaW5nKTogUHJvbWlzZTxQaG90byB8IG51bGw+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgncGhvdG9zJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmVxKCdpZCcsIHBob3RvSWQpXG4gICAgICAuc2luZ2xlKCk7XG4gICAgXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVBob3RvKHBob3RvSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIEdldCBwaG90byBkZXRhaWxzXG4gICAgY29uc3QgcGhvdG8gPSBhd2FpdCB0aGlzLmdldFBob3RvQnlJZChwaG90b0lkKTtcbiAgICBpZiAoIXBob3RvKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Bob3RvIG5vdCBmb3VuZCcpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBFeHRyYWN0IGZpbGUgcGF0aCBmcm9tIFVSTCBvciB1c2Ugc3RvcmVkIGZpbGVuYW1lXG4gICAgICBsZXQgZmlsZVBhdGg6IHN0cmluZztcbiAgICAgIFxuICAgICAgaWYgKHBob3RvLmZpbGVuYW1lKSB7XG4gICAgICAgIC8vIFVzZSBzdG9yZWQgZmlsZW5hbWUgaWYgYXZhaWxhYmxlXG4gICAgICAgIGlmIChwaG90by5pc19ob21lcGFnZSkge1xuICAgICAgICAgIGZpbGVQYXRoID0gYGhvbWVwYWdlLyR7cGhvdG8uZmlsZW5hbWV9YDtcbiAgICAgICAgfSBlbHNlIGlmIChwaG90by5ldmVudF9pZCkge1xuICAgICAgICAgIGZpbGVQYXRoID0gYGV2ZW50cy8ke3Bob3RvLmV2ZW50X2lkfS8ke3Bob3RvLmZpbGVuYW1lfWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gRmFsbGJhY2sgaWYgc3RydWN0dXJlIGlzIHVuY2xlYXJcbiAgICAgICAgICBmaWxlUGF0aCA9IHBob3RvLmZpbGVuYW1lO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBFeHRyYWN0IGZyb20gVVJMIGFzIGZhbGxiYWNrXG4gICAgICAgIGNvbnN0IHVybFBhcnRzID0gcGhvdG8udXJsLnNwbGl0KCcvJyk7XG4gICAgICAgIGNvbnN0IGZpbGVOYW1lID0gdXJsUGFydHNbdXJsUGFydHMubGVuZ3RoIC0gMV07XG4gICAgICAgIFxuICAgICAgICBpZiAocGhvdG8uaXNfaG9tZXBhZ2UpIHtcbiAgICAgICAgICBmaWxlUGF0aCA9IGBob21lcGFnZS8ke2ZpbGVOYW1lfWA7XG4gICAgICAgIH0gZWxzZSBpZiAocGhvdG8uZXZlbnRfaWQpIHtcbiAgICAgICAgICBmaWxlUGF0aCA9IGBldmVudHMvJHtwaG90by5ldmVudF9pZH0vJHtmaWxlTmFtZX1gO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEZhbGxiYWNrIGlmIHN0cnVjdHVyZSBpcyB1bmNsZWFyXG4gICAgICAgICAgZmlsZVBhdGggPSBmaWxlTmFtZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBEZWxldGUgZnJvbSBzdG9yYWdlIGZpcnN0XG4gICAgICBjb25zdCB7IGVycm9yOiBkZWxldGVTdG9yYWdlRXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2Uuc3RvcmFnZVxuICAgICAgICAuZnJvbSgncGhvdG9zJylcbiAgICAgICAgLnJlbW92ZShbZmlsZVBhdGhdKTtcblxuICAgICAgaWYgKGRlbGV0ZVN0b3JhZ2VFcnJvcikge1xuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBmaWxlIGZyb20gc3RvcmFnZTonLCBkZWxldGVTdG9yYWdlRXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIC8vIENvbnRpbnVlIHdpdGggZGF0YWJhc2UgZGVsZXRpb24gZXZlbiBpZiBzdG9yYWdlIGRlbGV0aW9uIGZhaWxzXG4gICAgICB9XG5cbiAgICAgIC8vIFRoZW4gZGVsZXRlIGZyb20gZGF0YWJhc2VcbiAgICAgIGNvbnN0IHsgZXJyb3I6IGRlbGV0ZURiRXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3Bob3RvcycpXG4gICAgICAgIC5kZWxldGUoKVxuICAgICAgICAuZXEoJ2lkJywgcGhvdG9JZCk7XG5cbiAgICAgIGlmIChkZWxldGVEYkVycm9yKSB0aHJvdyBkZWxldGVEYkVycm9yO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBJZiBpdCdzIG5vdCBhIHN0b3JhZ2UgZXJyb3IsIHJldGhyb3dcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmICFlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdzdG9yYWdlJykpIHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEZvciBzdG9yYWdlIGVycm9ycywgdHJ5IHRvIGRlbGV0ZSBmcm9tIGRhdGFiYXNlIGFueXdheVxuICAgICAgY29uc3QgeyBlcnJvcjogZGVsZXRlRGJFcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgICAuZnJvbSgncGhvdG9zJylcbiAgICAgICAgLmRlbGV0ZSgpXG4gICAgICAgIC5lcSgnaWQnLCBwaG90b0lkKTtcbiAgICAgICAgXG4gICAgICBpZiAoZGVsZXRlRGJFcnJvcikgdGhyb3cgZGVsZXRlRGJFcnJvcjtcbiAgICB9XG4gIH1cblxuICBhc3luYyBsaWtlUGhvdG8ocGhvdG9JZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZS5ycGMoJ2luY3JlbWVudF9saWtlcycsIHsgcGhvdG9faWQ6IHBob3RvSWQgfSk7IC8vIFBhbmdnaWwgZnVuZ3NpIFJQQ1xuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gIH1cblxuXG4gIC8vIC0tLSBNZXRvZGUgUGVzYW4gLS0tXG4gIGFzeW5jIGdldEV2ZW50TWVzc2FnZXMoZXZlbnRJZDogc3RyaW5nKTogUHJvbWlzZTxNZXNzYWdlW10+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgnbWVzc2FnZXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2V2ZW50X2lkJywgZXZlbnRJZClcbiAgICAgIC5vcmRlcignc2VudF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgYXN5bmMgY3JlYXRlTWVzc2FnZShtZXNzYWdlOiBPbWl0PE1lc3NhZ2UsICdpZCcgfCAnc2VudF9hdCcgfCAnaGVhcnRzJz4pOiBQcm9taXNlPE1lc3NhZ2U+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgnbWVzc2FnZXMnKVxuICAgICAgLmluc2VydChtZXNzYWdlKVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIGFzeW5jIGhlYXJ0TWVzc2FnZShtZXNzYWdlSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2UucnBjKCdpbmNyZW1lbnRfaGVhcnRzJywgeyBtZXNzYWdlX2lkOiBtZXNzYWdlSWQgfSk7IC8vIFBhbmdnaWwgZnVuZ3NpIFJQQ1xuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gIH1cblxuICBhc3luYyBnZXRNZXNzYWdlQnlJZChtZXNzYWdlSWQ6IHN0cmluZyk6IFByb21pc2U8TWVzc2FnZSB8IG51bGw+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgnbWVzc2FnZXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2lkJywgbWVzc2FnZUlkKVxuICAgICAgLnNpbmdsZSgpO1xuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cblxuICBhc3luYyB1cGRhdGVNZXNzYWdlSGVhcnRzKG1lc3NhZ2VJZDogc3RyaW5nLCBoZWFydHM6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdtZXNzYWdlcycpXG4gICAgICAudXBkYXRlKHsgaGVhcnRzIH0pXG4gICAgICAuZXEoJ2lkJywgbWVzc2FnZUlkKTtcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICB9XG5cbiAgYXN5bmMgYWRkTWVzc2FnZVJlYWN0aW9uKG1lc3NhZ2VJZDogc3RyaW5nLCByZWFjdGlvblR5cGU6IGtleW9mIE1lc3NhZ2VSZWFjdGlvbnMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBHZXQgY3VycmVudCBtZXNzYWdlXG4gICAgY29uc3QgbWVzc2FnZSA9IGF3YWl0IHRoaXMuZ2V0TWVzc2FnZUJ5SWQobWVzc2FnZUlkKTtcbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTWVzc2FnZSBub3QgZm91bmQnKTtcbiAgICB9XG5cbiAgICAvLyBHZXQgY3VycmVudCByZWFjdGlvbnMgb3IgaW5pdGlhbGl6ZVxuICAgIGNvbnN0IGN1cnJlbnRSZWFjdGlvbnM6IE1lc3NhZ2VSZWFjdGlvbnMgPSBtZXNzYWdlLnJlYWN0aW9ucyB8fCB7XG4gICAgICBsb3ZlOiAwLFxuICAgICAgbGF1Z2g6IDAsXG4gICAgICB3b3c6IDAsXG4gICAgICBzYWQ6IDAsXG4gICAgICBhbmdyeTogMFxuICAgIH07XG5cbiAgICAvLyBJbmNyZW1lbnQgdGhlIHNwZWNpZmljIHJlYWN0aW9uXG4gICAgY3VycmVudFJlYWN0aW9uc1tyZWFjdGlvblR5cGVdID0gKGN1cnJlbnRSZWFjdGlvbnNbcmVhY3Rpb25UeXBlXSB8fCAwKSArIDE7XG5cbiAgICAvLyBVcGRhdGUgaW4gZGF0YWJhc2VcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgnbWVzc2FnZXMnKVxuICAgICAgLnVwZGF0ZSh7IHJlYWN0aW9uczogY3VycmVudFJlYWN0aW9ucyB9KVxuICAgICAgLmVxKCdpZCcsIG1lc3NhZ2VJZCk7XG4gICAgXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZU1lc3NhZ2VSZWFjdGlvbnMobWVzc2FnZUlkOiBzdHJpbmcsIHJlYWN0aW9uczogTWVzc2FnZVJlYWN0aW9ucyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdtZXNzYWdlcycpXG4gICAgICAudXBkYXRlKHsgcmVhY3Rpb25zIH0pXG4gICAgICAuZXEoJ2lkJywgbWVzc2FnZUlkKTtcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICB9XG5cbiAgLy8gLS0tIE1ldG9kZSBTdGF0aXN0aWsgLS0tXG4gIGFzeW5jIGdldFN0YXRzKCk6IFByb21pc2U8U3RhdHM+IHtcbiAgICBjb25zdCB7IGNvdW50OiB0b3RhbEV2ZW50cywgZXJyb3I6IGV2ZW50c0Vycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgnZXZlbnRzJylcbiAgICAgIC5zZWxlY3QoJyonLCB7IGNvdW50OiAnZXhhY3QnLCBoZWFkOiB0cnVlIH0pO1xuICAgIGlmIChldmVudHNFcnJvcikgdGhyb3cgZXZlbnRzRXJyb3I7XG5cbiAgICBjb25zdCB7IGNvdW50OiB0b3RhbFBob3RvcywgZXJyb3I6IHBob3Rvc0Vycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgncGhvdG9zJylcbiAgICAgIC5zZWxlY3QoJyonLCB7IGNvdW50OiAnZXhhY3QnLCBoZWFkOiB0cnVlIH0pO1xuICAgIGlmIChwaG90b3NFcnJvcikgdGhyb3cgcGhvdG9zRXJyb3I7XG5cbiAgICBjb25zdCB7IGNvdW50OiB0b3RhbE1lc3NhZ2VzLCBlcnJvcjogbWVzc2FnZXNFcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ21lc3NhZ2VzJylcbiAgICAgIC5zZWxlY3QoJyonLCB7IGNvdW50OiAnZXhhY3QnLCBoZWFkOiB0cnVlIH0pO1xuICAgIGlmIChtZXNzYWdlc0Vycm9yKSB0aHJvdyBtZXNzYWdlc0Vycm9yO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsRXZlbnRzOiB0b3RhbEV2ZW50cyB8fCAwLFxuICAgICAgdG90YWxQaG90b3M6IHRvdGFsUGhvdG9zIHx8IDAsXG4gICAgICB0b3RhbE1lc3NhZ2VzOiB0b3RhbE1lc3NhZ2VzIHx8IDAsXG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgZGF0YWJhc2UgPSBuZXcgRGF0YWJhc2VTZXJ2aWNlKCk7ICJdLCJuYW1lcyI6WyJzdXBhYmFzZUFkbWluIiwiSW1hZ2VPcHRpbWl6ZXJTZXJ2ZXIiLCJEYXRhYmFzZVNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsInN1cGFiYXNlIiwiaW1hZ2VPcHRpbWl6ZXIiLCJnZXRBbGxFdmVudHMiLCJkYXRhIiwiZXJyb3IiLCJmcm9tIiwic2VsZWN0Iiwib3JkZXIiLCJhc2NlbmRpbmciLCJnZXRQdWJsaWNFdmVudHMiLCJpcyIsImdldEV2ZW50QnlJZCIsImlkIiwiZXEiLCJzaW5nbGUiLCJjcmVhdGVFdmVudCIsImV2ZW50IiwibmV3RXZlbnQiLCJpbnNlcnQiLCJiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX0FQUF9VUkwiLCJldmVudFVybCIsImFjY2Vzc19jb2RlIiwicXJDb2RlVXJsIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwidXBkYXRlZEV2ZW50IiwidXBkYXRlRXJyb3IiLCJ1cGRhdGUiLCJxcl9jb2RlIiwic2hhcmVhYmxlX2xpbmsiLCJjb25zb2xlIiwidXBkYXRlRXZlbnQiLCJ1cGRhdGVzIiwiZGVsZXRlRXZlbnQiLCJkZWxldGUiLCJ2ZXJpZnlFdmVudEFjY2Vzc0NvZGUiLCJldmVudElkIiwiY29kZSIsImdldEV2ZW50UGhvdG9zIiwiZ2V0SG9tZXBhZ2VQaG90b3MiLCJ2YWxpZGF0ZUZpbGVFeHRlbnNpb24iLCJmaWxlbmFtZSIsImFsbG93ZWRFeHRlbnNpb25zIiwiZXh0Iiwic3BsaXQiLCJwb3AiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwiZ2VuZXJhdGVGaWxlTmFtZSIsIm9yaWdpbmFsTmFtZSIsImZpbGVFeHQiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwicmFuZG9tU3RyIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwiZ2V0RXZlbnRzIiwiZ2V0U2ltcGxlQ29tcHJlc3Npb25BbmFseXRpY3MiLCJwaG90b3MiLCJwaG90b3NFcnJvciIsIm5vdCIsImxpbWl0IiwidG90YWxQaG90b3MiLCJsZW5ndGgiLCJ0b3RhbE9yaWdpbmFsU2l6ZSIsInRvdGFsT3B0aW1pemVkU2l6ZSIsInRvdGFsU2F2aW5nc0J5dGVzIiwicmVjZW50UGhvdG9zIiwiZm9yRWFjaCIsInBob3RvIiwiaW1hZ2VfbWV0YWRhdGEiLCJvcHRpbWl6ZWRfaW1hZ2VzIiwib3JpZ2luYWxTaXplIiwib3JpZ2luYWxfc2l6ZSIsIm9wdGltaXplZFNpemUiLCJtZWRpdW0iLCJzaXplIiwic2F2aW5ncyIsInNhdmluZ3NQZXJjZW50YWdlIiwicHVzaCIsIm9yaWdpbmFsX25hbWUiLCJvcHRpbWl6ZWRfc2l6ZSIsInNhdmluZ3NfcGVyY2VudGFnZSIsInVwbG9hZGVkX2F0IiwidG90YWxTYXZpbmdzUGVyY2VudGFnZSIsImF2ZXJhZ2VDb21wcmVzc2lvblJhdGlvIiwic3RvcmFnZVNhdmVkIiwiZm9ybWF0RmlsZVNpemUiLCJzb3J0IiwiYSIsImIiLCJieXRlcyIsImsiLCJzaXplcyIsImkiLCJmbG9vciIsImxvZyIsInBhcnNlRmxvYXQiLCJwb3ciLCJ0b0ZpeGVkIiwidmFsaWRhdGVFdmVudEFjY2VzcyIsIkVycm9yIiwidXBsb2FkRXZlbnRQaG90byIsImZpbGUiLCJ1cGxvYWRlck5hbWUiLCJhbGJ1bU5hbWUiLCJuYW1lIiwiYXJyYXlCdWZmZXIiLCJidWZmZXIiLCJCdWZmZXIiLCJvcHRpbWl6ZWRJbWFnZXMiLCJwcm9jZXNzSW1hZ2UiLCJzaGFycCIsImRlZmF1bHQiLCJtZXRhZGF0YSIsImltYWdlTWV0YWRhdGEiLCJ3aWR0aCIsImhlaWdodCIsImZvcm1hdCIsImNvbXByZXNzaW9uU3RhdHMiLCJnZXRDb21wcmVzc2lvblN0YXRzIiwicGhvdG9EYXRhIiwiaW5zZXJ0RXJyb3IiLCJldmVudF9pZCIsInVybCIsIm9yaWdpbmFsIiwidGh1bWJuYWlsX3VybCIsInRodW1ibmFpbCIsInVwbG9hZGVyX25hbWUiLCJhbGJ1bV9uYW1lIiwiaXNfaG9tZXBhZ2UiLCJjb21wcmVzc2lvbl9zdGF0cyIsInVwbG9hZEhvbWVwYWdlUGhvdG8iLCJnZXRQaG90b0J5SWQiLCJwaG90b0lkIiwiZGVsZXRlUGhvdG8iLCJmaWxlUGF0aCIsInVybFBhcnRzIiwiZmlsZU5hbWUiLCJkZWxldGVTdG9yYWdlRXJyb3IiLCJzdG9yYWdlIiwicmVtb3ZlIiwiZGVsZXRlRGJFcnJvciIsIm1lc3NhZ2UiLCJsaWtlUGhvdG8iLCJycGMiLCJwaG90b19pZCIsImdldEV2ZW50TWVzc2FnZXMiLCJjcmVhdGVNZXNzYWdlIiwiaGVhcnRNZXNzYWdlIiwibWVzc2FnZUlkIiwibWVzc2FnZV9pZCIsImdldE1lc3NhZ2VCeUlkIiwidXBkYXRlTWVzc2FnZUhlYXJ0cyIsImhlYXJ0cyIsImFkZE1lc3NhZ2VSZWFjdGlvbiIsInJlYWN0aW9uVHlwZSIsImN1cnJlbnRSZWFjdGlvbnMiLCJyZWFjdGlvbnMiLCJsb3ZlIiwibGF1Z2giLCJ3b3ciLCJzYWQiLCJhbmdyeSIsInVwZGF0ZU1lc3NhZ2VSZWFjdGlvbnMiLCJnZXRTdGF0cyIsImNvdW50IiwidG90YWxFdmVudHMiLCJldmVudHNFcnJvciIsImhlYWQiLCJ0b3RhbE1lc3NhZ2VzIiwibWVzc2FnZXNFcnJvciIsImRhdGFiYXNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/database.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/image-optimizer-server.ts":
/*!*******************************************!*\
  !*** ./src/lib/image-optimizer-server.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ImageOptimizerServer: () => (/* binding */ ImageOptimizerServer)\n/* harmony export */ });\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sharp */ \"sharp\");\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(sharp__WEBPACK_IMPORTED_MODULE_0__);\n/**\r\n * Server-side Image Optimization Service\r\n * Handles compression, resizing, and format conversion on the server\r\n */ \nclass ImageOptimizerServer {\n    constructor(supabase, bucketName = \"photos\"){\n        this.supabase = supabase;\n        this.bucketName = bucketName;\n    }\n    /**\r\n   * Generate filename for different sizes\r\n   */ generateFilename(originalName, size, timestamp) {\n        const ext = originalName.split(\".\").pop()?.toLowerCase() || \"jpg\";\n        const nameWithoutExt = originalName.replace(/\\.[^/.]+$/, \"\");\n        const cleanName = nameWithoutExt.replace(/[^a-zA-Z0-9]/g, \"_\");\n        return `${timestamp}_${cleanName}_${size}.${ext}`;\n    }\n    /**\r\n   * Optimize single image to specific size\r\n   */ async optimizeImage(buffer, width, height, quality) {\n        return await sharp__WEBPACK_IMPORTED_MODULE_0___default()(buffer).resize(width, height, {\n            fit: \"inside\",\n            withoutEnlargement: true,\n            background: {\n                r: 255,\n                g: 255,\n                b: 255,\n                alpha: 1\n            }\n        }).jpeg({\n            quality,\n            progressive: true,\n            mozjpeg: true\n        }).toBuffer();\n    }\n    /**\r\n   * Get image metadata\r\n   */ async getImageMetadata(buffer) {\n        const metadata = await sharp__WEBPACK_IMPORTED_MODULE_0___default()(buffer).metadata();\n        return {\n            width: metadata.width || 0,\n            height: metadata.height || 0,\n            format: metadata.format || \"jpeg\",\n            size: buffer.length\n        };\n    }\n    /**\r\n   * Upload buffer to Supabase Storage\r\n   */ async uploadToStorage(buffer, filePath, contentType = \"image/jpeg\") {\n        const { data, error } = await this.supabase.storage.from(this.bucketName).upload(filePath, buffer, {\n            contentType,\n            cacheControl: \"31536000\",\n            upsert: false\n        });\n        if (error) throw error;\n        const { data: publicUrlData } = this.supabase.storage.from(this.bucketName).getPublicUrl(data.path);\n        return publicUrlData.publicUrl;\n    }\n    /**\r\n   * Process and optimize image for all sizes (SERVER-SIDE ONLY)\r\n   */ async processImage(buffer, originalName, folder = \"optimized\") {\n        try {\n            // Get original metadata\n            const originalMetadata = await this.getImageMetadata(buffer);\n            const timestamp = Date.now();\n            const randomId = Math.random().toString(36).substring(2, 8);\n            // Define sizes\n            const sizes = {\n                thumbnail: {\n                    width: 300,\n                    height: 225,\n                    quality: 85\n                },\n                small: {\n                    width: 800,\n                    height: 600,\n                    quality: 90\n                },\n                medium: {\n                    width: 1200,\n                    height: 900,\n                    quality: 92\n                },\n                large: {\n                    width: 1920,\n                    height: 1440,\n                    quality: 95\n                }\n            };\n            // Upload original\n            const originalPath = `${folder}/original/${timestamp}_${randomId}_original.jpg`;\n            const originalUrl = await this.uploadToStorage(buffer, originalPath);\n            // Process and upload optimized versions\n            const results = {\n                original: {\n                    url: originalUrl,\n                    size: originalMetadata.size,\n                    width: originalMetadata.width,\n                    height: originalMetadata.height\n                },\n                thumbnail: {\n                    url: \"\",\n                    size: 0\n                },\n                small: {\n                    url: \"\",\n                    size: 0\n                },\n                medium: {\n                    url: \"\",\n                    size: 0\n                },\n                large: {\n                    url: \"\",\n                    size: 0\n                }\n            };\n            // Process each size\n            for (const [sizeName, config] of Object.entries(sizes)){\n                const optimizedBuffer = await this.optimizeImage(buffer, config.width, config.height, config.quality);\n                const optimizedPath = `${folder}/${sizeName}/${timestamp}_${randomId}_${sizeName}.jpg`;\n                const optimizedUrl = await this.uploadToStorage(optimizedBuffer, optimizedPath);\n                results[sizeName] = {\n                    url: optimizedUrl,\n                    size: optimizedBuffer.length\n                };\n            }\n            return results;\n        } catch (error) {\n            console.error(\"Image processing error:\", error);\n            throw new Error(\"Failed to process image\");\n        }\n    }\n    /**\r\n   * Get appropriate image URL based on viewport/usage\r\n   */ static getOptimalImageUrl(images, usage) {\n        switch(usage){\n            case \"thumbnail\":\n                return images.thumbnail.url;\n            case \"gallery\":\n                return images.medium.url;\n            case \"lightbox\":\n                return images.large.url;\n            case \"download\":\n                return images.original.url;\n            case \"mobile\":\n                return images.small.url;\n            default:\n                return images.medium.url;\n        }\n    }\n    /**\r\n   * Get responsive image sources for different screen sizes\r\n   */ static getResponsiveSources(images) {\n        return {\n            srcSet: [\n                `${images.small.url} 800w`,\n                `${images.medium.url} 1200w`,\n                `${images.large.url} 1920w`\n            ].join(\", \"),\n            sizes: [\n                \"(max-width: 768px) 800px\",\n                \"(max-width: 1200px) 1200px\",\n                \"1920px\"\n            ].join(\", \"),\n            src: images.medium.url,\n            placeholder: images.thumbnail.url\n        };\n    }\n    /**\r\n   * Calculate compression savings\r\n   */ static getCompressionStats(images) {\n        const originalSize = images.original.size;\n        const optimizedSize = images.medium.size;\n        const savings = (originalSize - optimizedSize) / originalSize * 100;\n        return {\n            originalSize: this.formatFileSize(originalSize),\n            optimizedSize: this.formatFileSize(optimizedSize),\n            savings: Math.round(savings),\n            ratio: `${Math.round(originalSize / optimizedSize)}:1`\n        };\n    }\n    /**\r\n   * Format file size for display\r\n   */ static formatFileSize(bytes) {\n        if (bytes === 0) return \"0 Bytes\";\n        const k = 1024;\n        const sizes = [\n            \"Bytes\",\n            \"KB\",\n            \"MB\",\n            \"GB\"\n        ];\n        const i = Math.floor(Math.log(bytes) / Math.log(k));\n        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + \" \" + sizes[i];\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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d0IsSUFBSSxDQUFDO1lBQ1BDLEtBQUtMLE9BQU9qQixNQUFNLENBQUNNLEdBQUc7WUFDdEJpQixhQUFhTixPQUFPbkIsU0FBUyxDQUFDUSxHQUFHO1FBQ25DO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE9BQU9rQixvQkFBb0JQLE1BQXVCLEVBQUU7UUFDbEQsTUFBTVEsZUFBZVIsT0FBT1osUUFBUSxDQUFDOUQsSUFBSTtRQUN6QyxNQUFNbUYsZ0JBQWdCVCxPQUFPakIsTUFBTSxDQUFDekQsSUFBSTtRQUN4QyxNQUFNb0YsVUFBVSxDQUFFRixlQUFlQyxhQUFZLElBQUtELGVBQWdCO1FBRWxFLE9BQU87WUFDTEEsY0FBYyxJQUFJLENBQUNHLGNBQWMsQ0FBQ0g7WUFDbENDLGVBQWUsSUFBSSxDQUFDRSxjQUFjLENBQUNGO1lBQ25DQyxTQUFTbEMsS0FBS29DLEtBQUssQ0FBQ0Y7WUFDcEJHLE9BQU8sQ0FBQyxFQUFFckMsS0FBS29DLEtBQUssQ0FBQ0osZUFBZUMsZUFBZSxFQUFFLENBQUM7UUFDeEQ7SUFDRjtJQUVBOztHQUVDLEdBQ0QsT0FBT0UsZUFBZUcsS0FBYSxFQUFVO1FBQzNDLElBQUlBLFVBQVUsR0FBRyxPQUFPO1FBQ3hCLE1BQU1DLElBQUk7UUFDVixNQUFNbkMsUUFBUTtZQUFDO1lBQVM7WUFBTTtZQUFNO1NBQUs7UUFDekMsTUFBTW9DLElBQUl4QyxLQUFLeUMsS0FBSyxDQUFDekMsS0FBSzBDLEdBQUcsQ0FBQ0osU0FBU3RDLEtBQUswQyxHQUFHLENBQUNIO1FBQ2hELE9BQU9JLFdBQVcsQ0FBQ0wsUUFBUXRDLEtBQUs0QyxHQUFHLENBQUNMLEdBQUdDLEVBQUMsRUFBR0ssT0FBTyxDQUFDLE1BQU0sTUFBTXpDLEtBQUssQ0FBQ29DLEVBQUU7SUFDekU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2hhZmlwb3J0cmFpdC1uZXh0anMvLi9zcmMvbGliL2ltYWdlLW9wdGltaXplci1zZXJ2ZXIudHM/ZjBlYyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogU2VydmVyLXNpZGUgSW1hZ2UgT3B0aW1pemF0aW9uIFNlcnZpY2VcclxuICogSGFuZGxlcyBjb21wcmVzc2lvbiwgcmVzaXppbmcsIGFuZCBmb3JtYXQgY29udmVyc2lvbiBvbiB0aGUgc2VydmVyXHJcbiAqL1xyXG5cclxuaW1wb3J0IHNoYXJwIGZyb20gJ3NoYXJwJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgT3B0aW1pemVkSW1hZ2VzIHtcclxuICBvcmlnaW5hbDoge1xyXG4gICAgdXJsOiBzdHJpbmc7XHJcbiAgICBzaXplOiBudW1iZXI7XHJcbiAgICB3aWR0aDogbnVtYmVyO1xyXG4gICAgaGVpZ2h0OiBudW1iZXI7XHJcbiAgfTtcclxuICB0aHVtYm5haWw6IHtcclxuICAgIHVybDogc3RyaW5nO1xyXG4gICAgc2l6ZTogbnVtYmVyO1xyXG4gIH07XHJcbiAgc21hbGw6IHtcclxuICAgIHVybDogc3RyaW5nO1xyXG4gICAgc2l6ZTogbnVtYmVyO1xyXG4gIH07XHJcbiAgbWVkaXVtOiB7XHJcbiAgICB1cmw6IHN0cmluZztcclxuICAgIHNpemU6IG51bWJlcjtcclxuICB9O1xyXG4gIGxhcmdlOiB7XHJcbiAgICB1cmw6IHN0cmluZztcclxuICAgIHNpemU6IG51bWJlcjtcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgSW1hZ2VPcHRpbWl6ZXJTZXJ2ZXIge1xyXG4gIHByaXZhdGUgc3VwYWJhc2U6IGFueTtcclxuICBwcml2YXRlIGJ1Y2tldE5hbWU6IHN0cmluZztcclxuXHJcbiAgY29uc3RydWN0b3Ioc3VwYWJhc2U6IGFueSwgYnVja2V0TmFtZTogc3RyaW5nID0gJ3Bob3RvcycpIHtcclxuICAgIHRoaXMuc3VwYWJhc2UgPSBzdXBhYmFzZTtcclxuICAgIHRoaXMuYnVja2V0TmFtZSA9IGJ1Y2tldE5hbWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSBmaWxlbmFtZSBmb3IgZGlmZmVyZW50IHNpemVzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZW5lcmF0ZUZpbGVuYW1lKG9yaWdpbmFsTmFtZTogc3RyaW5nLCBzaXplOiBzdHJpbmcsIHRpbWVzdGFtcDogbnVtYmVyKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGV4dCA9IG9yaWdpbmFsTmFtZS5zcGxpdCgnLicpLnBvcCgpPy50b0xvd2VyQ2FzZSgpIHx8ICdqcGcnO1xyXG4gICAgY29uc3QgbmFtZVdpdGhvdXRFeHQgPSBvcmlnaW5hbE5hbWUucmVwbGFjZSgvXFwuW14vLl0rJC8sICcnKTtcclxuICAgIGNvbnN0IGNsZWFuTmFtZSA9IG5hbWVXaXRob3V0RXh0LnJlcGxhY2UoL1teYS16QS1aMC05XS9nLCAnXycpO1xyXG4gICAgcmV0dXJuIGAke3RpbWVzdGFtcH1fJHtjbGVhbk5hbWV9XyR7c2l6ZX0uJHtleHR9YDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE9wdGltaXplIHNpbmdsZSBpbWFnZSB0byBzcGVjaWZpYyBzaXplXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBvcHRpbWl6ZUltYWdlKFxyXG4gICAgYnVmZmVyOiBCdWZmZXIsIFxyXG4gICAgd2lkdGg6IG51bWJlciwgXHJcbiAgICBoZWlnaHQ6IG51bWJlciwgXHJcbiAgICBxdWFsaXR5OiBudW1iZXJcclxuICApOiBQcm9taXNlPEJ1ZmZlcj4ge1xyXG4gICAgcmV0dXJuIGF3YWl0IHNoYXJwKGJ1ZmZlcilcclxuICAgICAgLnJlc2l6ZSh3aWR0aCwgaGVpZ2h0LCB7XHJcbiAgICAgICAgZml0OiAnaW5zaWRlJyxcclxuICAgICAgICB3aXRob3V0RW5sYXJnZW1lbnQ6IHRydWUsXHJcbiAgICAgICAgYmFja2dyb3VuZDogeyByOiAyNTUsIGc6IDI1NSwgYjogMjU1LCBhbHBoYTogMSB9XHJcbiAgICAgIH0pXHJcbiAgICAgIC5qcGVnKHtcclxuICAgICAgICBxdWFsaXR5LFxyXG4gICAgICAgIHByb2dyZXNzaXZlOiB0cnVlLFxyXG4gICAgICAgIG1vempwZWc6IHRydWVcclxuICAgICAgfSlcclxuICAgICAgLnRvQnVmZmVyKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgaW1hZ2UgbWV0YWRhdGFcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGdldEltYWdlTWV0YWRhdGEoYnVmZmVyOiBCdWZmZXIpIHtcclxuICAgIGNvbnN0IG1ldGFkYXRhID0gYXdhaXQgc2hhcnAoYnVmZmVyKS5tZXRhZGF0YSgpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgd2lkdGg6IG1ldGFkYXRhLndpZHRoIHx8IDAsXHJcbiAgICAgIGhlaWdodDogbWV0YWRhdGEuaGVpZ2h0IHx8IDAsXHJcbiAgICAgIGZvcm1hdDogbWV0YWRhdGEuZm9ybWF0IHx8ICdqcGVnJyxcclxuICAgICAgc2l6ZTogYnVmZmVyLmxlbmd0aFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwbG9hZCBidWZmZXIgdG8gU3VwYWJhc2UgU3RvcmFnZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgdXBsb2FkVG9TdG9yYWdlKFxyXG4gICAgYnVmZmVyOiBCdWZmZXIsIFxyXG4gICAgZmlsZVBhdGg6IHN0cmluZywgXHJcbiAgICBjb250ZW50VHlwZTogc3RyaW5nID0gJ2ltYWdlL2pwZWcnXHJcbiAgKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2Uuc3RvcmFnZVxyXG4gICAgICAuZnJvbSh0aGlzLmJ1Y2tldE5hbWUpXHJcbiAgICAgIC51cGxvYWQoZmlsZVBhdGgsIGJ1ZmZlciwge1xyXG4gICAgICAgIGNvbnRlbnRUeXBlLFxyXG4gICAgICAgIGNhY2hlQ29udHJvbDogJzMxNTM2MDAwJywgLy8gMSB5ZWFyIGNhY2hlXHJcbiAgICAgICAgdXBzZXJ0OiBmYWxzZVxyXG4gICAgICB9KTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YTogcHVibGljVXJsRGF0YSB9ID0gdGhpcy5zdXBhYmFzZS5zdG9yYWdlXHJcbiAgICAgIC5mcm9tKHRoaXMuYnVja2V0TmFtZSlcclxuICAgICAgLmdldFB1YmxpY1VybChkYXRhLnBhdGgpO1xyXG5cclxuICAgIHJldHVybiBwdWJsaWNVcmxEYXRhLnB1YmxpY1VybDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFByb2Nlc3MgYW5kIG9wdGltaXplIGltYWdlIGZvciBhbGwgc2l6ZXMgKFNFUlZFUi1TSURFIE9OTFkpXHJcbiAgICovXHJcbiAgYXN5bmMgcHJvY2Vzc0ltYWdlKFxyXG4gICAgYnVmZmVyOiBCdWZmZXIsIFxyXG4gICAgb3JpZ2luYWxOYW1lOiBzdHJpbmcsXHJcbiAgICBmb2xkZXI6IHN0cmluZyA9ICdvcHRpbWl6ZWQnXHJcbiAgKTogUHJvbWlzZTxPcHRpbWl6ZWRJbWFnZXM+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIEdldCBvcmlnaW5hbCBtZXRhZGF0YVxyXG4gICAgICBjb25zdCBvcmlnaW5hbE1ldGFkYXRhID0gYXdhaXQgdGhpcy5nZXRJbWFnZU1ldGFkYXRhKGJ1ZmZlcik7XHJcbiAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IERhdGUubm93KCk7XHJcbiAgICAgIGNvbnN0IHJhbmRvbUlkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDgpO1xyXG5cclxuICAgICAgLy8gRGVmaW5lIHNpemVzXHJcbiAgICAgIGNvbnN0IHNpemVzID0ge1xyXG4gICAgICAgIHRodW1ibmFpbDogeyB3aWR0aDogMzAwLCBoZWlnaHQ6IDIyNSwgcXVhbGl0eTogODUgfSxcclxuICAgICAgICBzbWFsbDogeyB3aWR0aDogODAwLCBoZWlnaHQ6IDYwMCwgcXVhbGl0eTogOTAgfSxcclxuICAgICAgICBtZWRpdW06IHsgd2lkdGg6IDEyMDAsIGhlaWdodDogOTAwLCBxdWFsaXR5OiA5MiB9LFxyXG4gICAgICAgIGxhcmdlOiB7IHdpZHRoOiAxOTIwLCBoZWlnaHQ6IDE0NDAsIHF1YWxpdHk6IDk1IH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIFVwbG9hZCBvcmlnaW5hbFxyXG4gICAgICBjb25zdCBvcmlnaW5hbFBhdGggPSBgJHtmb2xkZXJ9L29yaWdpbmFsLyR7dGltZXN0YW1wfV8ke3JhbmRvbUlkfV9vcmlnaW5hbC5qcGdgO1xyXG4gICAgICBjb25zdCBvcmlnaW5hbFVybCA9IGF3YWl0IHRoaXMudXBsb2FkVG9TdG9yYWdlKGJ1ZmZlciwgb3JpZ2luYWxQYXRoKTtcclxuXHJcbiAgICAgIC8vIFByb2Nlc3MgYW5kIHVwbG9hZCBvcHRpbWl6ZWQgdmVyc2lvbnNcclxuICAgICAgY29uc3QgcmVzdWx0czogT3B0aW1pemVkSW1hZ2VzID0ge1xyXG4gICAgICAgIG9yaWdpbmFsOiB7XHJcbiAgICAgICAgICB1cmw6IG9yaWdpbmFsVXJsLFxyXG4gICAgICAgICAgc2l6ZTogb3JpZ2luYWxNZXRhZGF0YS5zaXplLFxyXG4gICAgICAgICAgd2lkdGg6IG9yaWdpbmFsTWV0YWRhdGEud2lkdGgsXHJcbiAgICAgICAgICBoZWlnaHQ6IG9yaWdpbmFsTWV0YWRhdGEuaGVpZ2h0XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0aHVtYm5haWw6IHsgdXJsOiAnJywgc2l6ZTogMCB9LFxyXG4gICAgICAgIHNtYWxsOiB7IHVybDogJycsIHNpemU6IDAgfSxcclxuICAgICAgICBtZWRpdW06IHsgdXJsOiAnJywgc2l6ZTogMCB9LFxyXG4gICAgICAgIGxhcmdlOiB7IHVybDogJycsIHNpemU6IDAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gUHJvY2VzcyBlYWNoIHNpemVcclxuICAgICAgZm9yIChjb25zdCBbc2l6ZU5hbWUsIGNvbmZpZ10gb2YgT2JqZWN0LmVudHJpZXMoc2l6ZXMpKSB7XHJcbiAgICAgICAgY29uc3Qgb3B0aW1pemVkQnVmZmVyID0gYXdhaXQgdGhpcy5vcHRpbWl6ZUltYWdlKFxyXG4gICAgICAgICAgYnVmZmVyLFxyXG4gICAgICAgICAgY29uZmlnLndpZHRoLFxyXG4gICAgICAgICAgY29uZmlnLmhlaWdodCxcclxuICAgICAgICAgIGNvbmZpZy5xdWFsaXR5XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgY29uc3Qgb3B0aW1pemVkUGF0aCA9IGAke2ZvbGRlcn0vJHtzaXplTmFtZX0vJHt0aW1lc3RhbXB9XyR7cmFuZG9tSWR9XyR7c2l6ZU5hbWV9LmpwZ2A7XHJcbiAgICAgICAgY29uc3Qgb3B0aW1pemVkVXJsID0gYXdhaXQgdGhpcy51cGxvYWRUb1N0b3JhZ2Uob3B0aW1pemVkQnVmZmVyLCBvcHRpbWl6ZWRQYXRoKTtcclxuXHJcbiAgICAgICAgcmVzdWx0c1tzaXplTmFtZSBhcyBrZXlvZiB0eXBlb2Ygc2l6ZXNdID0ge1xyXG4gICAgICAgICAgdXJsOiBvcHRpbWl6ZWRVcmwsXHJcbiAgICAgICAgICBzaXplOiBvcHRpbWl6ZWRCdWZmZXIubGVuZ3RoXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdJbWFnZSBwcm9jZXNzaW5nIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gcHJvY2VzcyBpbWFnZScpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFwcHJvcHJpYXRlIGltYWdlIFVSTCBiYXNlZCBvbiB2aWV3cG9ydC91c2FnZVxyXG4gICAqL1xyXG4gIHN0YXRpYyBnZXRPcHRpbWFsSW1hZ2VVcmwoXHJcbiAgICBpbWFnZXM6IE9wdGltaXplZEltYWdlcywgXHJcbiAgICB1c2FnZTogJ3RodW1ibmFpbCcgfCAnZ2FsbGVyeScgfCAnbGlnaHRib3gnIHwgJ2Rvd25sb2FkJyB8ICdtb2JpbGUnXHJcbiAgKTogc3RyaW5nIHtcclxuICAgIHN3aXRjaCAodXNhZ2UpIHtcclxuICAgICAgY2FzZSAndGh1bWJuYWlsJzpcclxuICAgICAgICByZXR1cm4gaW1hZ2VzLnRodW1ibmFpbC51cmw7XHJcbiAgICAgIGNhc2UgJ2dhbGxlcnknOlxyXG4gICAgICAgIHJldHVybiBpbWFnZXMubWVkaXVtLnVybDtcclxuICAgICAgY2FzZSAnbGlnaHRib3gnOlxyXG4gICAgICAgIHJldHVybiBpbWFnZXMubGFyZ2UudXJsO1xyXG4gICAgICBjYXNlICdkb3dubG9hZCc6XHJcbiAgICAgICAgcmV0dXJuIGltYWdlcy5vcmlnaW5hbC51cmw7XHJcbiAgICAgIGNhc2UgJ21vYmlsZSc6XHJcbiAgICAgICAgcmV0dXJuIGltYWdlcy5zbWFsbC51cmw7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIGltYWdlcy5tZWRpdW0udXJsO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHJlc3BvbnNpdmUgaW1hZ2Ugc291cmNlcyBmb3IgZGlmZmVyZW50IHNjcmVlbiBzaXplc1xyXG4gICAqL1xyXG4gIHN0YXRpYyBnZXRSZXNwb25zaXZlU291cmNlcyhpbWFnZXM6IE9wdGltaXplZEltYWdlcykge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3JjU2V0OiBbXHJcbiAgICAgICAgYCR7aW1hZ2VzLnNtYWxsLnVybH0gODAwd2AsXHJcbiAgICAgICAgYCR7aW1hZ2VzLm1lZGl1bS51cmx9IDEyMDB3YCxcclxuICAgICAgICBgJHtpbWFnZXMubGFyZ2UudXJsfSAxOTIwd2BcclxuICAgICAgXS5qb2luKCcsICcpLFxyXG4gICAgICBzaXplczogW1xyXG4gICAgICAgICcobWF4LXdpZHRoOiA3NjhweCkgODAwcHgnLFxyXG4gICAgICAgICcobWF4LXdpZHRoOiAxMjAwcHgpIDEyMDBweCcsXHJcbiAgICAgICAgJzE5MjBweCdcclxuICAgICAgXS5qb2luKCcsICcpLFxyXG4gICAgICBzcmM6IGltYWdlcy5tZWRpdW0udXJsLCAvLyBGYWxsYmFja1xyXG4gICAgICBwbGFjZWhvbGRlcjogaW1hZ2VzLnRodW1ibmFpbC51cmxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWxjdWxhdGUgY29tcHJlc3Npb24gc2F2aW5nc1xyXG4gICAqL1xyXG4gIHN0YXRpYyBnZXRDb21wcmVzc2lvblN0YXRzKGltYWdlczogT3B0aW1pemVkSW1hZ2VzKSB7XHJcbiAgICBjb25zdCBvcmlnaW5hbFNpemUgPSBpbWFnZXMub3JpZ2luYWwuc2l6ZTtcclxuICAgIGNvbnN0IG9wdGltaXplZFNpemUgPSBpbWFnZXMubWVkaXVtLnNpemU7XHJcbiAgICBjb25zdCBzYXZpbmdzID0gKChvcmlnaW5hbFNpemUgLSBvcHRpbWl6ZWRTaXplKSAvIG9yaWdpbmFsU2l6ZSkgKiAxMDA7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG9yaWdpbmFsU2l6ZTogdGhpcy5mb3JtYXRGaWxlU2l6ZShvcmlnaW5hbFNpemUpLFxyXG4gICAgICBvcHRpbWl6ZWRTaXplOiB0aGlzLmZvcm1hdEZpbGVTaXplKG9wdGltaXplZFNpemUpLFxyXG4gICAgICBzYXZpbmdzOiBNYXRoLnJvdW5kKHNhdmluZ3MpLFxyXG4gICAgICByYXRpbzogYCR7TWF0aC5yb3VuZChvcmlnaW5hbFNpemUgLyBvcHRpbWl6ZWRTaXplKX06MWBcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGb3JtYXQgZmlsZSBzaXplIGZvciBkaXNwbGF5XHJcbiAgICovXHJcbiAgc3RhdGljIGZvcm1hdEZpbGVTaXplKGJ5dGVzOiBudW1iZXIpOiBzdHJpbmcge1xyXG4gICAgaWYgKGJ5dGVzID09PSAwKSByZXR1cm4gJzAgQnl0ZXMnO1xyXG4gICAgY29uc3QgayA9IDEwMjQ7XHJcbiAgICBjb25zdCBzaXplcyA9IFsnQnl0ZXMnLCAnS0InLCAnTUInLCAnR0InXTtcclxuICAgIGNvbnN0IGkgPSBNYXRoLmZsb29yKE1hdGgubG9nKGJ5dGVzKSAvIE1hdGgubG9nKGspKTtcclxuICAgIHJldHVybiBwYXJzZUZsb2F0KChieXRlcyAvIE1hdGgucG93KGssIGkpKS50b0ZpeGVkKDIpKSArICcgJyArIHNpemVzW2ldO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJzaGFycCIsIkltYWdlT3B0aW1pemVyU2VydmVyIiwiY29uc3RydWN0b3IiLCJzdXBhYmFzZSIsImJ1Y2tldE5hbWUiLCJnZW5lcmF0ZUZpbGVuYW1lIiwib3JpZ2luYWxOYW1lIiwic2l6ZSIsInRpbWVzdGFtcCIsImV4dCIsInNwbGl0IiwicG9wIiwidG9Mb3dlckNhc2UiLCJuYW1lV2l0aG91dEV4dCIsInJlcGxhY2UiLCJjbGVhbk5hbWUiLCJvcHRpbWl6ZUltYWdlIiwiYnVmZmVyIiwid2lkdGgiLCJoZWlnaHQiLCJxdWFsaXR5IiwicmVzaXplIiwiZml0Iiwid2l0aG91dEVubGFyZ2VtZW50IiwiYmFja2dyb3VuZCIsInIiLCJnIiwiYiIsImFscGhhIiwianBlZyIsInByb2dyZXNzaXZlIiwibW96anBlZyIsInRvQnVmZmVyIiwiZ2V0SW1hZ2VNZXRhZGF0YSIsIm1ldGFkYXRhIiwiZm9ybWF0IiwibGVuZ3RoIiwidXBsb2FkVG9TdG9yYWdlIiwiZmlsZVBhdGgiLCJjb250ZW50VHlwZSIsImRhdGEiLCJlcnJvciIsInN0b3JhZ2UiLCJmcm9tIiwidXBsb2FkIiwiY2FjaGVDb250cm9sIiwidXBzZXJ0IiwicHVibGljVXJsRGF0YSIsImdldFB1YmxpY1VybCIsInBhdGgiLCJwdWJsaWNVcmwiLCJwcm9jZXNzSW1hZ2UiLCJmb2xkZXIiLCJvcmlnaW5hbE1ldGFkYXRhIiwiRGF0ZSIsIm5vdyIsInJhbmRvbUlkIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwic2l6ZXMiLCJ0aHVtYm5haWwiLCJzbWFsbCIsIm1lZGl1bSIsImxhcmdlIiwib3JpZ2luYWxQYXRoIiwib3JpZ2luYWxVcmwiLCJyZXN1bHRzIiwib3JpZ2luYWwiLCJ1cmwiLCJzaXplTmFtZSIsImNvbmZpZyIsIk9iamVjdCIsImVudHJpZXMiLCJvcHRpbWl6ZWRCdWZmZXIiLCJvcHRpbWl6ZWRQYXRoIiwib3B0aW1pemVkVXJsIiwiY29uc29sZSIsIkVycm9yIiwiZ2V0T3B0aW1hbEltYWdlVXJsIiwiaW1hZ2VzIiwidXNhZ2UiLCJnZXRSZXNwb25zaXZlU291cmNlcyIsInNyY1NldCIsImpvaW4iLCJzcmMiLCJwbGFjZWhvbGRlciIsImdldENvbXByZXNzaW9uU3RhdHMiLCJvcmlnaW5hbFNpemUiLCJvcHRpbWl6ZWRTaXplIiwic2F2aW5ncyIsImZvcm1hdEZpbGVTaXplIiwicm91bmQiLCJyYXRpbyIsImJ5dGVzIiwiayIsImkiLCJmbG9vciIsImxvZyIsInBhcnNlRmxvYXQiLCJwb3ciLCJ0b0ZpeGVkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/image-optimizer-server.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase.ts":
/*!*****************************!*\
  !*** ./src/lib/supabase.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   STORAGE_BUCKET: () => (/* binding */ STORAGE_BUCKET),\n/* harmony export */   deleteFile: () => (/* binding */ deleteFile),\n/* harmony export */   generateFilePath: () => (/* binding */ generateFilePath),\n/* harmony export */   supabase: () => (/* binding */ supabase),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin),\n/* harmony export */   uploadFile: () => (/* binding */ uploadFile)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n// Create Supabase client for client-side operations\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(\"https://azspktldiblhrwebzmwq.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF6c3BrdGxkaWJsaHJ3ZWJ6bXdxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM5NDQwNDQsImV4cCI6MjA2OTUyMDA0NH0.uKHB4K9hxUDTc0ZkwidCJv_Ev-oa99AflFvrFt_8MG8\");\n// Create Supabase admin client for server-side operations\n// Pastikan ini diekspor langsung agar 'database' bisa menggunakannya\nconst supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(\"https://azspktldiblhrwebzmwq.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY, {\n    auth: {\n        autoRefreshToken: false,\n        persistSession: false\n    }\n});\n// Storage bucket name\nconst STORAGE_BUCKET = process.env.SUPABASE_STORAGE_BUCKET || \"photos\"; // Menggunakan default 'photos'\n// Upload file to Supabase Storage\nasync function uploadFile(file, path) {\n    const { data, error } = await supabaseAdmin.storage.from(STORAGE_BUCKET).upload(path, file, {\n        cacheControl: \"3600\",\n        upsert: false\n    });\n    if (error) {\n        throw new Error(`Upload failed: ${error.message}`);\n    }\n    // Get public URL\n    const { data: publicUrlData } = supabaseAdmin.storage.from(STORAGE_BUCKET).getPublicUrl(data.path);\n    return publicUrlData.publicUrl;\n}\n// Delete file from Supabase Storage\nasync function deleteFile(path) {\n    const { error } = await supabaseAdmin.storage.from(STORAGE_BUCKET).remove([\n        path\n    ]);\n    if (error) {\n        throw new Error(`Delete failed: ${error.message}`);\n    }\n}\n// Generate unique file path\nfunction generateFilePath(folder, originalName, eventId) {\n    const timestamp = Date.now();\n    const randomStr = Math.random().toString(36).substring(2, 8);\n    const fileExtension = originalName.split(\".\").pop();\n    const fileName = `${timestamp}_${randomStr}.${fileExtension}`;\n    if (eventId) {\n        return `${folder}/${eventId}/${fileName}`;\n    }\n    return `${folder}/${fileName}`;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBcUQ7QUFFckQsb0RBQW9EO0FBQzdDLE1BQU1DLFdBQVdELG1FQUFZQSxDQUNsQ0UsMENBQW9DLEVBQ3BDQSxrTkFBeUMsRUFDekM7QUFFRiwwREFBMEQ7QUFDMUQscUVBQXFFO0FBQzlELE1BQU1JLGdCQUFnQk4sbUVBQVlBLENBQ3ZDRSwwQ0FBb0MsRUFDcENBLFFBQVFDLEdBQUcsQ0FBQ0kseUJBQXlCLEVBQ3JDO0lBQ0VDLE1BQU07UUFDSkMsa0JBQWtCO1FBQ2xCQyxnQkFBZ0I7SUFDbEI7QUFDRixHQUNBO0FBRUYsc0JBQXNCO0FBQ2YsTUFBTUMsaUJBQWlCVCxRQUFRQyxHQUFHLENBQUNTLHVCQUF1QixJQUFJLFNBQVMsQ0FBQywrQkFBK0I7QUFFOUcsa0NBQWtDO0FBQzNCLGVBQWVDLFdBQVdDLElBQVUsRUFBRUMsSUFBWTtJQUN2RCxNQUFNLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTVgsY0FBY1ksT0FBTyxDQUNoREMsSUFBSSxDQUFDUixnQkFDTFMsTUFBTSxDQUFDTCxNQUFNRCxNQUFNO1FBQ2xCTyxjQUFjO1FBQ2RDLFFBQVE7SUFDVjtJQUVGLElBQUlMLE9BQU87UUFDVCxNQUFNLElBQUlNLE1BQU0sQ0FBQyxlQUFlLEVBQUVOLE1BQU1PLE9BQU8sQ0FBQyxDQUFDO0lBQ25EO0lBRUEsaUJBQWlCO0lBQ2pCLE1BQU0sRUFBRVIsTUFBTVMsYUFBYSxFQUFFLEdBQUduQixjQUFjWSxPQUFPLENBQ2xEQyxJQUFJLENBQUNSLGdCQUNMZSxZQUFZLENBQUNWLEtBQUtELElBQUk7SUFFekIsT0FBT1UsY0FBY0UsU0FBUztBQUNoQztBQUVBLG9DQUFvQztBQUM3QixlQUFlQyxXQUFXYixJQUFZO0lBQzNDLE1BQU0sRUFBRUUsS0FBSyxFQUFFLEdBQUcsTUFBTVgsY0FBY1ksT0FBTyxDQUMxQ0MsSUFBSSxDQUFDUixnQkFDTGtCLE1BQU0sQ0FBQztRQUFDZDtLQUFLO0lBRWhCLElBQUlFLE9BQU87UUFDVCxNQUFNLElBQUlNLE1BQU0sQ0FBQyxlQUFlLEVBQUVOLE1BQU1PLE9BQU8sQ0FBQyxDQUFDO0lBQ25EO0FBQ0Y7QUFFQSw0QkFBNEI7QUFDckIsU0FBU00saUJBQ2RDLE1BQWMsRUFDZEMsWUFBb0IsRUFDcEJDLE9BQWdCO0lBRWhCLE1BQU1DLFlBQVlDLEtBQUtDLEdBQUc7SUFDMUIsTUFBTUMsWUFBWUMsS0FBS0MsTUFBTSxHQUFHQyxRQUFRLENBQUMsSUFBSUMsU0FBUyxDQUFDLEdBQUc7SUFDMUQsTUFBTUMsZ0JBQWdCVixhQUFhVyxLQUFLLENBQUMsS0FBS0MsR0FBRztJQUNqRCxNQUFNQyxXQUFXLENBQUMsRUFBRVgsVUFBVSxDQUFDLEVBQUVHLFVBQVUsQ0FBQyxFQUFFSyxjQUFjLENBQUM7SUFFN0QsSUFBSVQsU0FBUztRQUNYLE9BQU8sQ0FBQyxFQUFFRixPQUFPLENBQUMsRUFBRUUsUUFBUSxDQUFDLEVBQUVZLFNBQVMsQ0FBQztJQUMzQztJQUVBLE9BQU8sQ0FBQyxFQUFFZCxPQUFPLENBQUMsRUFBRWMsU0FBUyxDQUFDO0FBQ2hDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaGFmaXBvcnRyYWl0LW5leHRqcy8uL3NyYy9saWIvc3VwYWJhc2UudHM/MDZlMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xuXG4vLyBDcmVhdGUgU3VwYWJhc2UgY2xpZW50IGZvciBjbGllbnQtc2lkZSBvcGVyYXRpb25zXG5leHBvcnQgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoXG4gIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIVxuKTtcblxuLy8gQ3JlYXRlIFN1cGFiYXNlIGFkbWluIGNsaWVudCBmb3Igc2VydmVyLXNpZGUgb3BlcmF0aW9uc1xuLy8gUGFzdGlrYW4gaW5pIGRpZWtzcG9yIGxhbmdzdW5nIGFnYXIgJ2RhdGFiYXNlJyBiaXNhIG1lbmdndW5ha2FubnlhXG5leHBvcnQgY29uc3Qgc3VwYWJhc2VBZG1pbiA9IGNyZWF0ZUNsaWVudChcbiAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMISxcbiAgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSEsXG4gIHtcbiAgICBhdXRoOiB7XG4gICAgICBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSxcbiAgICAgIHBlcnNpc3RTZXNzaW9uOiBmYWxzZVxuICAgIH1cbiAgfVxuKTtcblxuLy8gU3RvcmFnZSBidWNrZXQgbmFtZVxuZXhwb3J0IGNvbnN0IFNUT1JBR0VfQlVDS0VUID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU1RPUkFHRV9CVUNLRVQgfHwgJ3Bob3Rvcyc7IC8vIE1lbmdndW5ha2FuIGRlZmF1bHQgJ3Bob3RvcydcblxuLy8gVXBsb2FkIGZpbGUgdG8gU3VwYWJhc2UgU3RvcmFnZVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwbG9hZEZpbGUoZmlsZTogRmlsZSwgcGF0aDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pbi5zdG9yYWdlXG4gICAgLmZyb20oU1RPUkFHRV9CVUNLRVQpXG4gICAgLnVwbG9hZChwYXRoLCBmaWxlLCB7XG4gICAgICBjYWNoZUNvbnRyb2w6ICczNjAwJyxcbiAgICAgIHVwc2VydDogZmFsc2VcbiAgICB9KTtcblxuICBpZiAoZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFVwbG9hZCBmYWlsZWQ6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgfVxuXG4gIC8vIEdldCBwdWJsaWMgVVJMXG4gIGNvbnN0IHsgZGF0YTogcHVibGljVXJsRGF0YSB9ID0gc3VwYWJhc2VBZG1pbi5zdG9yYWdlXG4gICAgLmZyb20oU1RPUkFHRV9CVUNLRVQpXG4gICAgLmdldFB1YmxpY1VybChkYXRhLnBhdGgpO1xuXG4gIHJldHVybiBwdWJsaWNVcmxEYXRhLnB1YmxpY1VybDtcbn1cblxuLy8gRGVsZXRlIGZpbGUgZnJvbSBTdXBhYmFzZSBTdG9yYWdlXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRmlsZShwYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pbi5zdG9yYWdlXG4gICAgLmZyb20oU1RPUkFHRV9CVUNLRVQpXG4gICAgLnJlbW92ZShbcGF0aF0pO1xuXG4gIGlmIChlcnJvcikge1xuICAgIHRocm93IG5ldyBFcnJvcihgRGVsZXRlIGZhaWxlZDogJHtlcnJvci5tZXNzYWdlfWApO1xuICB9XG59XG5cbi8vIEdlbmVyYXRlIHVuaXF1ZSBmaWxlIHBhdGhcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUZpbGVQYXRoKFxuICBmb2xkZXI6IHN0cmluZywgXG4gIG9yaWdpbmFsTmFtZTogc3RyaW5nLCBcbiAgZXZlbnRJZD86IHN0cmluZ1xuKTogc3RyaW5nIHtcbiAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKTtcbiAgY29uc3QgcmFuZG9tU3RyID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDgpO1xuICBjb25zdCBmaWxlRXh0ZW5zaW9uID0gb3JpZ2luYWxOYW1lLnNwbGl0KCcuJykucG9wKCk7XG4gIGNvbnN0IGZpbGVOYW1lID0gYCR7dGltZXN0YW1wfV8ke3JhbmRvbVN0cn0uJHtmaWxlRXh0ZW5zaW9ufWA7XG4gIFxuICBpZiAoZXZlbnRJZCkge1xuICAgIHJldHVybiBgJHtmb2xkZXJ9LyR7ZXZlbnRJZH0vJHtmaWxlTmFtZX1gO1xuICB9XG4gIFxuICByZXR1cm4gYCR7Zm9sZGVyfS8ke2ZpbGVOYW1lfWA7XG59ICJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJzdXBhYmFzZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlQWRtaW4iLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiYXV0aCIsImF1dG9SZWZyZXNoVG9rZW4iLCJwZXJzaXN0U2Vzc2lvbiIsIlNUT1JBR0VfQlVDS0VUIiwiU1VQQUJBU0VfU1RPUkFHRV9CVUNLRVQiLCJ1cGxvYWRGaWxlIiwiZmlsZSIsInBhdGgiLCJkYXRhIiwiZXJyb3IiLCJzdG9yYWdlIiwiZnJvbSIsInVwbG9hZCIsImNhY2hlQ29udHJvbCIsInVwc2VydCIsIkVycm9yIiwibWVzc2FnZSIsInB1YmxpY1VybERhdGEiLCJnZXRQdWJsaWNVcmwiLCJwdWJsaWNVcmwiLCJkZWxldGVGaWxlIiwicmVtb3ZlIiwiZ2VuZXJhdGVGaWxlUGF0aCIsImZvbGRlciIsIm9yaWdpbmFsTmFtZSIsImV2ZW50SWQiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwicmFuZG9tU3RyIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwiZmlsZUV4dGVuc2lvbiIsInNwbGl0IiwicG9wIiwiZmlsZU5hbWUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/next","vendor-chunks/ws","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions","vendor-chunks/isows"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fstats%2Froute&page=%2Fapi%2Fadmin%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fstats%2Froute.ts&appDir=%2Fhome%2Fdevbox%2Fhafi-portrait-stable%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fdevbox%2Fhafi-portrait-stable&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();